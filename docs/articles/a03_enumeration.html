<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Coloc: enumeration of configurations under a single causal variant assumption • coloc</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Coloc: enumeration of configurations under a single causal variant assumption">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">coloc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">4.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a01_intro.html">Coloc: a package for colocalisation analyses</a>
    </li>
    <li>
      <a href="../articles/a02_proportionality.html">Coloc: proportionality testing</a>
    </li>
    <li>
      <a href="../articles/a03_enumeration.html">Coloc: enumeration of configurations under a single causal variant assumption</a>
    </li>
    <li>
      <a href="../articles/a04_sensitivity.html">Coloc: sensitivity to prior values</a>
    </li>
    <li>
      <a href="../articles/a05_conditioning.html">Coloc: relaxing the single causal variant assumption</a>
    </li>
    <li>
      <a href="../articles/simdata.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/chr1swallace/coloc">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Coloc: enumeration of configurations under a single causal variant assumption</h1>
                        <h4 class="author">Chris Wallace</h4>
            
            <h4 class="date">2020-03-02</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/chr1swallace/coloc/blob/master/vignettes/a03_enumeration.Rmd"><code>vignettes/a03_enumeration.Rmd</code></a></small>
      <div class="hidden name"><code>a03_enumeration.Rmd</code></div>

    </div>

    
    
<p>% % % ## Simulate a small dataset</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(mvtnorm)
simx &lt;-<span class="st"> </span><span class="cf">function</span>(nsnps,nsamples,S,<span class="dt">maf=</span><span class="fl">0.1</span>) {
    mu &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">0</span>,nsnps)
    rawvars &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html">rmvnorm</a></span>(<span class="dt">n=</span>nsamples, <span class="dt">mean=</span>mu, <span class="dt">sigma=</span>S)
    pvars &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span>(rawvars)
    x &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Binomial.html">qbinom</a></span>(<span class="dv">1</span><span class="op">-</span>pvars, <span class="dv">2</span>, maf)
}


sim.data &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">nsnps=</span><span class="dv">50</span>,<span class="dt">nsamples=</span><span class="dv">200</span>,<span class="dt">causals=</span><span class="kw"><a href="https://rdrr.io/r/base/Round.html">floor</a></span>(nsnps<span class="op">/</span><span class="dv">2</span>),<span class="dt">nsim=</span><span class="dv">1</span>) {
  <span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">"Generate"</span>,nsim,<span class="st">"small sets of data</span><span class="ch">\n</span><span class="st">"</span>)
  ntotal &lt;-<span class="st"> </span>nsnps <span class="op">*</span><span class="st"> </span>nsamples <span class="op">*</span><span class="st"> </span>nsim
  S &lt;-<span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/outer.html">outer</a></span>(<span class="dv">1</span><span class="op">:</span>nsnps,<span class="dv">1</span><span class="op">:</span>nsnps,<span class="st">`</span><span class="dt">-</span><span class="st">`</span>))<span class="op">/</span>nsnps))<span class="op">^</span><span class="dv">4</span>
  X1 &lt;-<span class="st"> </span><span class="kw">simx</span>(nsnps,ntotal,S)
  X2 &lt;-<span class="st"> </span><span class="kw">simx</span>(nsnps,ntotal,S)
  Y1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(ntotal,<span class="kw"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span>(X1[,causals,<span class="dt">drop=</span><span class="ot">FALSE</span>]<span class="op">/</span><span class="dv">2</span>),<span class="dv">2</span>)
  Y2 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(ntotal,<span class="kw"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span>(X2[,causals,<span class="dt">drop=</span><span class="ot">FALSE</span>]<span class="op">/</span><span class="dv">2</span>),<span class="dv">2</span>)
  <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(X1) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(X2) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"s"</span>,<span class="dv">1</span><span class="op">:</span>nsnps,<span class="dt">sep=</span><span class="st">""</span>)
  df1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="dt">Y=</span>Y1,X1)
  df2 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="dt">Y=</span>Y2,X2)
  <span class="cf">if</span>(nsim<span class="op">==</span><span class="dv">1</span>) {
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="kw">new</span>(<span class="st">"simdata"</span>,
               <span class="dt">df1=</span><span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(df1),
               <span class="dt">df2=</span><span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(df2)))
  } <span class="cf">else</span> {
    index &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/split.html">split</a></span>(<span class="dv">1</span><span class="op">:</span>(nsamples <span class="op">*</span><span class="st"> </span>nsim), <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">1</span><span class="op">:</span>nsim, nsamples))
    objects &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(index, <span class="cf">function</span>(i) <span class="kw">new</span>(<span class="st">"simdata"</span>, <span class="dt">df1=</span><span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(df1[i,]),
                                             <span class="dt">df2=</span><span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(df2[i,])))
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(objects)
  }
}

<span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">46411</span>)
data &lt;-<span class="st"> </span><span class="kw">sim.data</span>()</code></pre></div>
<pre><code>## Generate 1 small sets of data</code></pre>
<div id="fine-mapping-under-a-single-causal-variant-assumption" class="section level1">
<h1 class="hasAnchor">
<a href="#fine-mapping-under-a-single-causal-variant-assumption" class="anchor"></a>Fine mapping under a single causal variant assumption</h1>
<p>The Approximate Bayes Factor colocalisation analysis described in the next section essentially works by fine mapping each trait under a single causal variant assumption and then integrating over those two posterior distributions to calculate probabilities that those variants are shared. Of course, this means we can look at each trait on its own quite simply, and we can do that with the function <code>finemap.abf</code>.</p>
<p>First we analyse a single trait from our simulated data to generate summary statistics:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(coloc)</code></pre></div>
<pre><code>## This is the condmask *development* branch of coloc.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Y1 &lt;-<span class="st"> </span>data<span class="op">@</span>df1<span class="op">$</span>Y
X1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(data<span class="op">@</span>df1[,<span class="op">-</span><span class="dv">1</span>])
tests1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(X1), <span class="cf">function</span>(i) <span class="kw"><a href="../reference/eta.html">summary</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(Y1 <span class="op">~</span><span class="st"> </span>X1[,i]))<span class="op">$</span>coefficients[<span class="dv">2</span>,])
p1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(tests1,<span class="st">"["</span>,<span class="dv">4</span>)
maf &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colSums.html">colMeans</a></span>(X1)<span class="op">/</span><span class="dv">2</span>

get.beta &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
   beta &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(x,<span class="st">"["</span>,<span class="dv">1</span>)
   varbeta &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(x, <span class="st">"["</span>, <span class="dv">2</span>)<span class="op">^</span><span class="dv">2</span>
   <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">beta=</span>beta,<span class="dt">varbeta=</span>varbeta))
}
b1 &lt;-<span class="st"> </span><span class="kw">get.beta</span>(tests1)</code></pre></div>
<p>Then we analyse them:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my.res &lt;-<span class="st"> </span><span class="kw"><a href="../reference/finemap.abf.html">finemap.abf</a></span>(<span class="dt">dataset=</span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">beta=</span>b1<span class="op">$</span>beta, <span class="dt">varbeta=</span>b1<span class="op">$</span>varbeta, <span class="dt">N=</span><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(X1),<span class="dt">sdY=</span><span class="kw"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(Y1),<span class="dt">type=</span><span class="st">"quant"</span>))
<span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(my.res)</code></pre></div>
<pre><code>##            V.         z.        r.     lABF.   snp prior       SNP.PP
## 1 0.002248351  0.5101674 0.9756883 -1.731428 SNP.1 1e-04 9.675623e-18
## 2 0.002218556  0.3250072 0.9760028 -1.813361 SNP.2 1e-04 8.914476e-18
## 3 0.002181928 -0.3514567 0.9763896 -1.812731 SNP.3 1e-04 8.920090e-18
## 4 0.002225538  0.4669162 0.9759291 -1.756994 SNP.4 1e-04 9.431394e-18
## 5 0.002161220 -0.2858021 0.9766084 -1.837804 SNP.5 1e-04 8.699221e-18
## 6 0.002167510  0.4312465 0.9765420 -1.785466 SNP.6 1e-04 9.166650e-18</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">tail</a></span>(my.res) </code></pre></div>
<pre><code>##             V.         z.        r.     lABF.    snp  prior       SNP.PP
## 46 0.002176805  0.2602080 0.9764437 -1.841125 SNP.46 0.0001 8.670377e-18
## 47 0.002122981  0.3517147 0.9770128 -1.825979 SNP.47 0.0001 8.802699e-18
## 48 0.002172939 -0.1407900 0.9764846 -1.865372 SNP.48 0.0001 8.462678e-18
## 49 0.002179537 -0.5589458 0.9764149 -1.721043 SNP.49 0.0001 9.776623e-18
## 50 0.002195664 -0.6658666 0.9762445 -1.653548 SNP.50 0.0001 1.045928e-17
## 51          NA         NA        NA  0.000000   null 0.9950 5.438155e-13</code></pre>
<p>The <code>SNP.PP</code> column shows the posterior probability that exactly that SNP is causal. Note the last line in this data.frame does not correspond to a SNP, but to the null model, that no SNP is causal.</p>
<p>Finally, if you do have full genotype data as here, while this is a fast method for fine mapping, it can be sensible to consider multiple causal variant models too. One package that allows you to do this is <a href="http://github.com/chr1swallace/GUESSFM">GUESSFM</a>, described in<sup><a id="fnr.5" class="footref" href="#fn.5">5</a></sup></p>
<p><a id="org6973f37"></a></p>
</div>
<div id="approximate-bayes-factor-colocalisation-analyses" class="section level1">
<h1 class="hasAnchor">
<a href="#approximate-bayes-factor-colocalisation-analyses" class="anchor"></a>(Approximate) Bayes Factor colocalisation analyses</h1>
<p><a id="org192e16b"></a></p>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The idea behind the ABF analysis is that the association of each trait with SNPs in a region may be summarised by a vector of 0s and at most a single 1, with the 1 indicating the causal SNP (so, assuming a single causal SNP for each trait). The posterior probability of each possible configuration can be calculated and so, crucially, can the posterior probabilities that the traits share their configurations. This allows us to estimate the support for the following cases:</p>
<ul>
<li>
<span class="math inline">\(H_0\)</span>: neither trait has a genetic association in the region</li>
<li>
<span class="math inline">\(H_1\)</span>: only trait 1 has a genetic association in the region</li>
<li>
<span class="math inline">\(H_2\)</span>: only trait 2 has a genetic association in the region</li>
<li>
<span class="math inline">\(H_3\)</span>: both traits are associated, but with different causal variants</li>
<li>
<span class="math inline">\(H_4\)</span>: both traits are associated and share a single causal variant</li>
</ul>
<p><a id="orgb0fa807"></a></p>
</div>
<div id="the-basic-coloc-abf-function" class="section level2">
<h2 class="hasAnchor">
<a href="#the-basic-coloc-abf-function" class="anchor"></a>The basic <code>coloc.abf</code> function</h2>
<p>The function <code>coloc.abf</code> is ideally suited to the case when only summary data are available, and requires, for each trait, either:</p>
<ul>
<li>p values for each SNP</li>
<li>each SNP’s minor allele frequency</li>
<li>sample size</li>
<li>ratio of cases:controls (if using a case-control trait)</li>
</ul>
<p>or:</p>
<ul>
<li>regression coefficients for each SNP</li>
<li>variance of these regression coefficients.</li>
</ul>
<p>If regression coefficients and their variance are available, please use these, but we can also approximate Bayes Factors from p values and minor allele frequencies, although, note, such approximation can be less accurate when imputed data are used. NB, you can mix and match, depending on the data available from each study.</p>
<p>A wrapper function is avalailable to run all these steps but we will first generate the p values manually to give all the details. We will calculate the coefficients and their standard errors, and the set of p values, to compare analysis of the two types of input data (but you should use only one - the coefficients if available, otherwise the p values).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Y1 &lt;-<span class="st"> </span>data<span class="op">@</span>df1<span class="op">$</span>Y
Y2 &lt;-<span class="st"> </span>data<span class="op">@</span>df2<span class="op">$</span>Y

X1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(data<span class="op">@</span>df1[,<span class="op">-</span><span class="dv">1</span>])
X2 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(data<span class="op">@</span>df2[,<span class="op">-</span><span class="dv">1</span>])

tests1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(X1), <span class="cf">function</span>(i) <span class="kw"><a href="../reference/eta.html">summary</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(Y1 <span class="op">~</span><span class="st"> </span>X1[,i]))<span class="op">$</span>coefficients[<span class="dv">2</span>,])
tests2 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(X2), <span class="cf">function</span>(i) <span class="kw"><a href="../reference/eta.html">summary</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(Y2 <span class="op">~</span><span class="st"> </span>X2[,i]))<span class="op">$</span>coefficients[<span class="dv">2</span>,])

p1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(tests1,<span class="st">"["</span>,<span class="dv">4</span>)
p2 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(tests2,<span class="st">"["</span>,<span class="dv">4</span>)

maf &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colSums.html">colMeans</a></span>(X2)<span class="op">/</span><span class="dv">2</span>

get.beta &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
   beta &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(x,<span class="st">"["</span>,<span class="dv">1</span>)
   varbeta &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(x, <span class="st">"["</span>, <span class="dv">2</span>)<span class="op">^</span><span class="dv">2</span>
   <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">beta=</span>beta,<span class="dt">varbeta=</span>varbeta))
}
b1 &lt;-<span class="st"> </span><span class="kw">get.beta</span>(tests1)
b2 &lt;-<span class="st"> </span><span class="kw">get.beta</span>(tests2)</code></pre></div>
<p>Note that we are using the second dataset in that case to compute the minor allele frequencies. This is unlikely to make any significant difference but one could have used dataset 1 instead. It is now possible to compute the probabilities of interest.</p>
<p>With coefficients, and std. deviation of Y known, we have the most accurate inference. Note that if you have a case-control trait, set type=“cc” and supply s, the proportion of samples in the dataset that are cases (from which sdY can be derived), instead of giving sdY directly.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my.res &lt;-<span class="st"> </span><span class="kw"><a href="../reference/coloc.abf.html">coloc.abf</a></span>(<span class="dt">dataset1=</span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">beta=</span>b1<span class="op">$</span>beta, <span class="dt">varbeta=</span>b1<span class="op">$</span>varbeta, <span class="dt">N=</span><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(X1),<span class="dt">sdY=</span><span class="kw"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(Y1),<span class="dt">type=</span><span class="st">"quant"</span>),
                    <span class="dt">dataset2=</span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">beta=</span>b2<span class="op">$</span>beta, <span class="dt">varbeta=</span>b2<span class="op">$</span>varbeta, <span class="dt">N=</span><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(X2),<span class="dt">sdY=</span><span class="kw"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(Y2),<span class="dt">type=</span><span class="st">"quant"</span>),
                    <span class="dt">MAF=</span>maf)</code></pre></div>
<pre><code>## PP.H0.abf PP.H1.abf PP.H2.abf PP.H3.abf PP.H4.abf 
##  1.41e-37  2.59e-25  5.47e-16  2.41e-11  1.00e+00 
## [1] "PP abf for shared variant: 100%"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(my.res) </code></pre></div>
<pre><code>## $summary
##        nsnps    PP.H0.abf    PP.H1.abf    PP.H2.abf    PP.H3.abf    PP.H4.abf 
## 5.000000e+01 1.413084e-37 2.585470e-25 5.465483e-16 2.410934e-11 1.000000e+00 
## 
## $results
##       snp       V.df1      z.df1     r.df1    lABF.df1       V.df2       z.df2
## 1   SNP.1 0.002248351  0.5101674 0.9756883 -1.73142783 0.002240831 -1.10376855
## 2  SNP.10 0.002216572 -0.4229438 0.9760237 -1.77804884 0.002290141  0.79620230
## 3  SNP.11 0.002256274  0.1135572 0.9756047 -1.85039303 0.002267750  1.29211486
## 4  SNP.12 0.002258409  1.7454514 0.9755822 -0.37011724 0.002254242  2.02125687
## 5  SNP.13 0.002253584  0.4475297 0.9756331 -1.75956389 0.002241118  2.61543074
## 6  SNP.14 0.002373830 -0.2061958 0.9743663 -1.81121014 0.002278650  1.52405058
## 7  SNP.15 0.002277719  2.0235830 0.9753786  0.14496383 0.002244983  2.02101657
## 8  SNP.16 0.002345311  1.6705133 0.9746664 -0.47785346 0.002318885  2.17719432
## 9  SNP.17 0.002355946  2.7890767 0.9745545  1.95489680 0.002238614  2.78557687
## 10 SNP.18 0.002380345  3.8519679 0.9742977  5.39755948 0.002236990  2.91073206
## 11 SNP.19 0.002313262  4.5294246 0.9750040  8.15691909 0.002280724  3.63499500
## 12  SNP.2 0.002218556  0.3250072 0.9760028 -1.81336107 0.002296733 -1.77020814
## 13 SNP.20 0.002346499  3.5684070 0.9746539  4.36782586 0.002257958  4.81302492
## 14 SNP.21 0.002296588  4.3100797 0.9751797  7.20980626 0.002367878  6.16777332
## 15 SNP.22 0.002290492  5.2138989 0.9752439 11.40653486 0.002326984  7.36436814
## 16 SNP.23 0.002328530  5.4543279 0.9748432 12.65932958 0.002290340  8.36524654
## 17 SNP.24 0.002315421  5.7224136 0.9749812 14.11931158 0.002230718  8.13779553
## 18 SNP.25 0.002320934  8.9776356 0.9749232 37.44549415 0.002193216 11.15903157
## 19 SNP.26 0.002272269  6.6773851 0.9754361 19.89287629 0.002187693  7.87948196
## 20 SNP.27 0.002267481  5.8812387 0.9754865 15.01627016 0.002202258  7.23236585
## 21 SNP.28 0.002216999  5.2241684 0.9760192 11.45347535 0.002197784  6.57148436
## 22 SNP.29 0.002250296  4.0348304 0.9756678  6.08388819 0.002128018  6.96423899
## 23  SNP.3 0.002181928 -0.3514567 0.9763896 -1.81273150 0.002290303 -1.19165151
## 24 SNP.30 0.002262298  3.4123437 0.9755412  3.82426189 0.002145053  6.09250043
## 25 SNP.31 0.002250164  3.4144153 0.9756692  3.82928253 0.002148988  6.03280953
## 26 SNP.32 0.002218638  3.7517273 0.9760019  5.00394642 0.002139734  5.29710269
## 27 SNP.33 0.002232329  3.0867450 0.9758574  2.78709373 0.002096668  4.92333045
## 28 SNP.34 0.002256674  2.7540873 0.9756005  1.84336651 0.002135113  4.51213603
## 29 SNP.35 0.002236704  2.5264008 0.9758112  1.25322238 0.002120791  3.93346257
## 30 SNP.36 0.002199390  1.1468268 0.9762052 -1.22718489 0.002153017  3.25623150
## 31 SNP.37 0.002149793  0.7578883 0.9767292 -1.59976492 0.002161713  3.07340575
## 32 SNP.38 0.002225981  1.5917590 0.9759244 -0.62692990 0.002170962  1.87473676
## 33 SNP.39 0.002194572  1.7125057 0.9762560 -0.43869229 0.002165222  1.64383390
## 34  SNP.4 0.002225538  0.4669162 0.9759291 -1.75699358 0.002256109 -1.02808641
## 35 SNP.40 0.002200820  1.8464972 0.9761901 -0.20464052 0.002196444  1.74658470
## 36 SNP.41 0.002211155  2.3197382 0.9760809  0.75969681 0.002288362  1.37966583
## 37 SNP.42 0.002214347  1.6891523 0.9760472 -0.47338886 0.002266495  0.67627818
## 38 SNP.43 0.002191942  1.9952936 0.9762838  0.07259012 0.002236402  0.97540724
## 39 SNP.44 0.002199154  1.3828520 0.9762076 -0.93580448 0.002283331  1.33486156
## 40 SNP.45 0.002191796  1.3981612 0.9762854 -0.91658335 0.002288721  0.96313135
## 41 SNP.46 0.002176805  0.2602080 0.9764437 -1.84112527 0.002297642  1.06785733
## 42 SNP.47 0.002122981  0.3517147 0.9770128 -1.82597908 0.002324535  2.10798086
## 43 SNP.48 0.002172939 -0.1407900 0.9764846 -1.86537179 0.002345562  0.27434269
## 44 SNP.49 0.002179537 -0.5589458 0.9764149 -1.72104342 0.002321837  0.97025628
## 45  SNP.5 0.002161220 -0.2858021 0.9766084 -1.83780407 0.002233398  0.07076934
## 46 SNP.50 0.002195664 -0.6658666 0.9762445 -1.65354792 0.002336758 -0.21429284
## 47  SNP.6 0.002167510  0.4312465 0.9765420 -1.78546561 0.002210686  0.04417980
## 48  SNP.7 0.002174043  0.7162531 0.9764729 -1.62432730 0.002209486 -0.74654551
## 49  SNP.8 0.002174984  1.2132337 0.9764630 -1.15594496 0.002223095 -0.05128667
## 50  SNP.9 0.002140028  0.9778754 0.9768325 -1.41545912 0.002243580 -0.27773054
##        r.df2   lABF.df2 internal.sum.lABF    SNP.PP.H4
## 1  0.9758491 -1.2672753       -2.99870311 7.044462e-44
## 2  0.9753307 -1.5419489       -3.31999775 5.108711e-44
## 3  0.9755660 -1.0415072       -2.89190019 7.838478e-44
## 4  0.9757080  0.1343125       -0.23580470 1.116245e-42
## 5  0.9758460  1.4759731       -0.28359083 1.064158e-42
## 6  0.9754515 -0.7206965       -2.53190662 1.123505e-43
## 7  0.9758054  0.1320296        0.27699338 1.864081e-42
## 8  0.9750288  0.4658869       -0.01196658 1.396275e-42
## 9  0.9758724  1.9239117        3.87880852 6.834601e-41
## 10 0.9758895  2.2714907        7.66905023 3.025480e-39
## 11 0.9754297  4.5911601       12.74807919 4.859465e-37
## 12 0.9752615 -0.3216392       -2.13500022 1.670895e-43
## 13 0.9756690  9.4427864       13.81061223 1.406179e-36
## 14 0.9745147 16.7011385       23.91094478 3.424202e-32
## 15 0.9749438 24.5941942       36.00072906 6.096576e-27
## 16 0.9753286 32.2744006       44.93373020 4.619969e-23
## 17 0.9759554 30.4517747       44.57108629 3.214733e-23
## 18 0.9763501 58.9173051       96.36279924 1.000000e+00
## 19 0.9764083 28.4373275       48.33020376 1.379459e-21
## 20 0.9762549 23.6623496       38.67861979 8.873178e-26
## 21 0.9763020 19.2093290       30.66280436 2.929913e-29
## 22 0.9770370 21.8065169       27.89040512 1.831543e-30
## 23 0.9753290 -1.1585642       -2.97129575 7.240202e-44
## 24 0.9768574 16.2467305       20.07099241 7.360194e-34
## 25 0.9768160 15.8933606       19.72264314 5.195210e-34
## 26 0.9769135 11.8214993       16.82544573 2.866595e-35
## 27 0.9773676  9.9511090       12.73820276 4.811707e-37
## 28 0.9769622  8.0598586        9.90322512 2.825427e-38
## 29 0.9771132  5.6704125        6.92363487 1.435702e-39
## 30 0.9767735  3.2971551        2.06997020 1.119811e-41
## 31 0.9766819  2.7335195        1.13375456 4.390878e-42
## 32 0.9765845 -0.1610073       -0.78793725 6.426451e-43
## 33 0.9766449 -0.5589305       -0.99762275 5.210819e-43
## 34 0.9756884 -1.3427685       -3.09976204 6.367346e-44
## 35 0.9763161 -0.3823260       -0.58696648 7.856909e-43
## 36 0.9753494 -0.9231995       -0.16350264 1.199941e-42
## 37 0.9755792 -1.6330690       -2.10645787 1.719274e-43
## 38 0.9758957 -1.3984387       -1.32584855 3.752834e-43
## 39 0.9754023 -0.9835380       -1.91934245 2.073042e-43
## 40 0.9753457 -1.3990250       -2.31560832 1.394801e-43
## 41 0.9752519 -1.2934547       -3.13457994 6.149464e-44
## 42 0.9749695  0.3223488       -1.50363028 3.141591e-43
## 43 0.9747488 -1.8027595       -3.66813125 3.606773e-44
## 44 0.9749978 -1.3854664       -3.10650983 6.324526e-44
## 45 0.9759272 -1.8608935       -3.69869752 3.498196e-44
## 46 0.9748412 -1.8188910       -3.47243892 4.386387e-44
## 47 0.9761662 -1.8673729       -3.65283855 3.662355e-44
## 48 0.9761789 -1.5965638       -3.22089107 5.640957e-44
## 49 0.9760356 -1.8643102       -3.02025518 6.894263e-44
## 50 0.9758202 -1.8234833       -3.23894242 5.540044e-44
## 
## $priors
##    p1    p2   p12 
## 1e-04 1e-04 1e-05 
## 
## attr(,"class")
## [1] "coloc_abf" "list"</code></pre>
<p>When std. deviation of Y is unknown, coloc will try and estimate sdY from variance of beta and MAF, but this can be noisy, particularly for small datasets, and will produce a warning:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my.res &lt;-<span class="st"> </span><span class="kw"><a href="../reference/coloc.abf.html">coloc.abf</a></span>(<span class="dt">dataset1=</span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">beta=</span>b1<span class="op">$</span>beta, <span class="dt">varbeta=</span>b1<span class="op">$</span>varbeta, <span class="dt">N=</span><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(X1),<span class="dt">type=</span><span class="st">"quant"</span>),
                    <span class="dt">dataset2=</span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">beta=</span>b2<span class="op">$</span>beta, <span class="dt">varbeta=</span>b2<span class="op">$</span>varbeta, <span class="dt">N=</span><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(X2),<span class="dt">type=</span><span class="st">"quant"</span>),
                    <span class="dt">MAF=</span>maf)</code></pre></div>
<pre><code>## Warning in sdY.est(d$varbeta, d$MAF, d$N): estimating sdY from maf and varbeta,
## please directly supply sdY if known

## Warning in sdY.est(d$varbeta, d$MAF, d$N): estimating sdY from maf and varbeta,
## please directly supply sdY if known</code></pre>
<pre><code>## PP.H0.abf PP.H1.abf PP.H2.abf PP.H3.abf PP.H4.abf 
##  1.41e-37  2.58e-25  5.45e-16  2.41e-11  1.00e+00 
## [1] "PP abf for shared variant: 100%"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(my.res) </code></pre></div>
<pre><code>## $summary
##        nsnps    PP.H0.abf    PP.H1.abf    PP.H2.abf    PP.H3.abf    PP.H4.abf 
## 5.000000e+01 1.408198e-37 2.582454e-25 5.452944e-16 2.405891e-11 1.000000e+00 
## 
## $results
##       snp       V.df1      z.df1     r.df1    lABF.df1       V.df2       z.df2
## 1   SNP.1 0.002248351  0.5101674 0.9757980 -1.73367468 0.002240831 -1.10376855
## 2  SNP.10 0.002216572 -0.4229438 0.9761319 -1.78030105 0.002290141  0.79620230
## 3  SNP.11 0.002256274  0.1135572 0.9757148 -1.85265325 0.002267750  1.29211486
## 4  SNP.12 0.002258409  1.7454514 0.9756924 -0.37221031 0.002254242  2.02125687
## 5  SNP.13 0.002253584  0.4475297 0.9757431 -1.76181388 0.002241118  2.61543074
## 6  SNP.14 0.002373830 -0.2061958 0.9744818 -1.81346575 0.002278650  1.52405058
## 7  SNP.15 0.002277719  2.0235830 0.9754896  0.14293081 0.002244983  2.02101657
## 8  SNP.16 0.002345311  1.6705133 0.9747806 -0.47995289 0.002318885  2.17719432
## 9  SNP.17 0.002355946  2.7890767 0.9746692  1.95308434 0.002238614  2.78557687
## 10 SNP.18 0.002380345  3.8519679 0.9744135  5.39616072 0.002236990  2.91073206
## 11 SNP.19 0.002313262  4.5294246 0.9751167  8.15581566 0.002280724  3.63499500
## 12  SNP.2 0.002218556  0.3250072 0.9761111 -1.81561719 0.002296733 -1.77020814
## 13 SNP.20 0.002346499  3.5684070 0.9747682  4.36629448 0.002257958  4.81302492
## 14 SNP.21 0.002296588  4.3100797 0.9752916  7.20858598 0.002367878  6.16777332
## 15 SNP.22 0.002290492  5.2138989 0.9753556 11.40579235 0.002326984  7.36436814
## 16 SNP.23 0.002328530  5.4543279 0.9749566 12.65875737 0.002290340  8.36524654
## 17 SNP.24 0.002315421  5.7224136 0.9750940 14.11889903 0.002230718  8.13779553
## 18 SNP.25 0.002320934  8.9776356 0.9750362 37.44779096 0.002193216 11.15903157
## 19 SNP.26 0.002272269  6.6773851 0.9755469 19.89308601 0.002187693  7.87948196
## 20 SNP.27 0.002267481  5.8812387 0.9755971 15.01592198 0.002202258  7.23236585
## 21 SNP.28 0.002216999  5.2241684 0.9761275 11.45269049 0.002197784  6.57148436
## 22 SNP.29 0.002250296  4.0348304 0.9757776  6.08252076 0.002128018  6.96423899
## 23  SNP.3 0.002181928 -0.3514567 0.9764962 -1.81498766 0.002290303 -1.19165151
## 24 SNP.30 0.002262298  3.4123437 0.9756515  3.82264353 0.002145053  6.09250043
## 25 SNP.31 0.002250164  3.4144153 0.9757790  3.82766137 0.002148988  6.03280953
## 26 SNP.32 0.002218638  3.7517273 0.9761102  5.00244687 0.002139734  5.29710269
## 27 SNP.33 0.002232329  3.0867450 0.9759663  2.78535126 0.002096668  4.92333045
## 28 SNP.34 0.002256674  2.7540873 0.9757106  1.84152308 0.002135113  4.51213603
## 29 SNP.35 0.002236704  2.5264008 0.9759204  1.25130933 0.002120791  3.93346257
## 30 SNP.36 0.002199390  1.1468268 0.9763126 -1.22937656 0.002153017  3.25623150
## 31 SNP.37 0.002149793  0.7578883 0.9768344 -1.60199827 0.002161713  3.07340575
## 32 SNP.38 0.002225981  1.5917590 0.9760331 -0.62905392 0.002170962  1.87473676
## 33 SNP.39 0.002194572  1.7125057 0.9763632 -0.44079754 0.002165222  1.64383390
## 34  SNP.4 0.002225538  0.4669162 0.9760377 -1.75924342 0.002256109 -1.02808641
## 35 SNP.40 0.002200820  1.8464972 0.9762975 -0.20671956 0.002196444  1.74658470
## 36 SNP.41 0.002211155  2.3197382 0.9761889  0.75772528 0.002288362  1.37966583
## 37 SNP.42 0.002214347  1.6891523 0.9761553 -0.47549657 0.002266495  0.67627818
## 38 SNP.43 0.002191942  1.9952936 0.9763909  0.07054076 0.002236402  0.97540724
## 39 SNP.44 0.002199154  1.3828520 0.9763151 -0.93796410 0.002283331  1.33486156
## 40 SNP.45 0.002191796  1.3981612 0.9763924 -0.91874120 0.002288721  0.96313135
## 41 SNP.46 0.002176805  0.2602080 0.9765501 -1.84338454 0.002297642  1.06785733
## 42 SNP.47 0.002122981  0.3517147 0.9771167 -1.82823684 0.002324535  2.10798086
## 43 SNP.48 0.002172939 -0.1407900 0.9765908 -1.86763370 0.002345562  0.27434269
## 44 SNP.49 0.002179537 -0.5589458 0.9765214 -1.72328958 0.002321837  0.97025628
## 45  SNP.5 0.002161220 -0.2858021 0.9767141 -1.84006300 0.002233398  0.07076934
## 46 SNP.50 0.002195664 -0.6658666 0.9763518 -1.65578655 0.002336758 -0.21429284
## 47  SNP.6 0.002167510  0.4312465 0.9766479 -1.78771885 0.002210686  0.04417980
## 48  SNP.7 0.002174043  0.7162531 0.9765792 -1.62656299 0.002209486 -0.74654551
## 49  SNP.8 0.002174984  1.2132337 0.9765693 -1.15812965 0.002223095 -0.05128667
## 50  SNP.9 0.002140028  0.9778754 0.9769372 -1.41767285 0.002243580 -0.27773054
##        r.df2   lABF.df2 internal.sum.lABF    SNP.PP.H4
## 1  0.9758781 -1.2678580       -3.00153270 7.000265e-44
## 2  0.9753603 -1.5425396       -3.32284066 5.076592e-44
## 3  0.9755953 -1.0420829       -2.89473616 7.789250e-44
## 4  0.9757372  0.1337718       -0.23843853 1.109458e-42
## 5  0.9758750  1.4754718       -0.28634206 1.057564e-42
## 6  0.9754809 -0.7212624       -2.53472818 1.116465e-43
## 7  0.9758344  0.1314885        0.27441929 1.852859e-42
## 8  0.9750588  0.4653580       -0.01459494 1.387794e-42
## 9  0.9759013  1.9234236        3.87650799 6.795315e-41
## 10 0.9759184  2.2710129        7.66717362 3.009364e-39
## 11 0.9754592  4.5907547       12.74657034 4.835359e-37
## 12 0.9752911 -0.3221927       -2.13780989 1.660445e-43
## 13 0.9756982  9.4425242       13.80881871 1.398806e-36
## 14 0.9745452 16.7011199       23.90970587 3.408136e-32
## 15 0.9749739 24.5944090       36.00020134 6.072288e-27
## 16 0.9753582 32.2748359       44.93359329 4.603363e-23
## 17 0.9759843 30.4521298       44.57102883 3.203432e-23
## 18 0.9763785 58.9184724       96.36626335 1.000000e+00
## 19 0.9764366 28.4376061       48.33069213 1.375360e-21
## 20 0.9762834 23.6624946       38.67841653 8.840696e-26
## 21 0.9763305 19.2093427       30.66203317 2.917530e-29
## 22 0.9770646 21.8065849       27.88910565 1.822839e-30
## 23 0.9753586 -1.1591433       -2.97413097 7.194737e-44
## 24 0.9768852 16.2466455       20.06928901 7.322259e-34
## 25 0.9768438 15.8932664       19.72092779 5.168371e-34
## 26 0.9769412 11.8212874       16.82373425 2.851797e-35
## 27 0.9773949  9.9508374       12.73618865 4.785420e-37
## 28 0.9769899  8.0595393        9.90106236 2.809573e-38
## 29 0.9771407  5.6700241        6.92133339 1.427449e-39
## 30 0.9768014  3.2967020        2.06732547 1.112991e-41
## 31 0.9767099  2.7330509        1.13105259 4.363887e-42
## 32 0.9766126 -0.1615588       -0.79061269 6.387117e-43
## 33 0.9766730 -0.5594934       -1.00029098 5.178962e-43
## 34 0.9757176 -1.3433533       -3.10259675 6.327366e-44
## 35 0.9763446 -0.3828833       -0.58960283 7.809124e-43
## 36 0.9753790 -0.9237714       -0.16604612 1.192753e-42
## 37 0.9756085 -1.6336625       -2.10915911 1.708706e-43
## 38 0.9759246 -1.3990253       -1.32848456 3.730011e-43
## 39 0.9754318 -0.9841118       -1.92207591 2.060234e-43
## 40 0.9753752 -1.3996113       -2.31835254 1.386168e-43
## 41 0.9752816 -1.2940378       -3.13742231 6.110804e-44
## 42 0.9749995  0.3218156       -1.50642121 3.122002e-43
## 43 0.9747791 -1.8033580       -3.67099174 3.584034e-44
## 44 0.9750278 -1.3860522       -3.10934175 6.284831e-44
## 45 0.9759561 -1.8614938       -3.70155682 3.476145e-44
## 46 0.9748714 -1.8194901       -3.47527664 4.358832e-44
## 47 0.9761948 -1.8679735       -3.65569236 3.639289e-44
## 48 0.9762074 -1.5971564       -3.22371938 5.605573e-44
## 49 0.9760644 -1.8649107       -3.02304034 6.851314e-44
## 50 0.9758492 -1.8240826       -3.24175541 5.505377e-44
## 
## $priors
##    p1    p2   p12 
## 1e-04 1e-04 1e-05 
## 
## attr(,"class")
## [1] "coloc_abf" "list"</code></pre>
<p>When only p values are available, we can use the form:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my.res &lt;-<span class="st"> </span><span class="kw"><a href="../reference/coloc.abf.html">coloc.abf</a></span>(<span class="dt">dataset1=</span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">pvalues=</span>p1,<span class="dt">N=</span><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(X1),<span class="dt">type=</span><span class="st">"quant"</span>),
                    <span class="dt">dataset2=</span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">pvalues=</span>p2,<span class="dt">N=</span><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(X2),<span class="dt">type=</span><span class="st">"quant"</span>),
                    <span class="dt">MAF=</span>maf)</code></pre></div>
<pre><code>## PP.H0.abf PP.H1.abf PP.H2.abf PP.H3.abf PP.H4.abf 
##  2.36e-37  3.78e-25  6.24e-16  2.62e-11  1.00e+00 
## [1] "PP abf for shared variant: 100%"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(my.res) </code></pre></div>
<pre><code>## $summary
##        nsnps    PP.H0.abf    PP.H1.abf    PP.H2.abf    PP.H3.abf    PP.H4.abf 
## 5.000000e+01 2.356833e-37 3.778986e-25 6.236681e-16 2.622332e-11 1.000000e+00 
## 
## $results
##       snp  pvalues.df1 MAF.df1        V.df1     z.df1     r.df1   lABF.df1
## 1   SNP.1 6.099455e-01 0.09965 0.0005572901 0.5101513 0.9758302 -1.7343436
## 2  SNP.10 6.723454e-01 0.09795 0.0005658938 0.4229313 0.9754662 -1.7666107
## 3  SNP.11 9.095911e-01 0.10020 0.0005545699 0.1135543 0.9759453 -1.8574210
## 4  SNP.12 8.093704e-02 0.10005 0.0005553088 1.7452749 0.9759141 -0.3767541
## 5  SNP.13 6.545024e-01 0.10105 0.0005504250 0.4475162 0.9761208 -1.7696302
## 6  SNP.14 8.366422e-01 0.09965 0.0005572901 0.2061904 0.9758302 -1.8405822
## 7  SNP.15 4.303962e-02 0.09900 0.0005605444 2.0233253 0.9756925  0.1386820
## 8  SNP.16 9.484915e-02 0.09660 0.0005729448 1.6703550 0.9751681 -0.4874120
## 9  SNP.17 5.295851e-03 0.10020 0.0005545699 2.7884647 0.9759453  1.9305356
## 10 SNP.18 1.179041e-04 0.10080 0.0005516367 3.8504436 0.9760695  5.3692613
## 11 SNP.19 5.982964e-06 0.09820 0.0005646096 4.5269905 0.9755205  8.1410244
## 12  SNP.2 7.451824e-01 0.09750 0.0005682222 0.3249982 0.9753678 -1.8003383
## 13 SNP.20 3.608403e-04 0.09820 0.0005646096 3.5671824 0.9755205  4.3516870
## 14 SNP.21 1.647583e-05 0.09615 0.0005753397 4.3079719 0.9750669  7.2021695
## 15 SNP.22 1.886070e-07 0.09770 0.0005671847 5.2102297 0.9754116 11.3867619
## 16 SNP.23 5.032997e-08 0.09925 0.0005592876 5.4501407 0.9757457 12.6322113
## 17 SNP.24 1.080433e-08 0.10170 0.0005473028 5.7175934 0.9762531 14.0871319
## 18 SNP.25 3.264582e-19 0.10205 0.0005456383 8.9593972 0.9763236 37.3134984
## 19 SNP.26 2.561668e-11 0.10170 0.0005473028 6.6697917 0.9762531 19.8447051
## 20 SNP.27 4.202612e-09 0.10100 0.0005506669 5.8760146 0.9761106 14.9841927
## 21 SNP.28 1.784619e-07 0.10145 0.0005484988 5.2204780 0.9762024 11.4333271
## 22 SNP.29 5.504854e-05 0.10355 0.0005386341 4.0330885 0.9766204  6.0648117
## 23  SNP.3 7.252532e-01 0.09760 0.0005677029 0.3514468 0.9753897 -1.7920577
## 24 SNP.30 6.466209e-04 0.10365 0.0005381744 3.4112655 0.9766399  3.8040859
## 25 SNP.31 6.417296e-04 0.10235 0.0005442208 3.4133352 0.9763836  3.8149455
## 26 SNP.32 1.766132e-04 0.10385 0.0005372579 3.7503141 0.9766787  4.9892279
## 27 SNP.33 2.029146e-03 0.10620 0.0005267507 3.0859329 0.9771244  2.7637266
## 28 SNP.34 5.896244e-03 0.10415 0.0005358897 2.7534963 0.9767367  1.8222428
## 29 SNP.35 1.153910e-02 0.10515 0.0005313865 2.5259345 0.9769277  1.2320063
## 30 SNP.36 2.514807e-01 0.10280 0.0005421103 1.1467604 0.9764731 -1.2327446
## 31 SNP.37 4.485357e-01 0.10320 0.0005402499 0.7578584 0.9765519 -1.5960421
## 32 SNP.38 1.114705e-01 0.10330 0.0005397871 1.5916184 0.9765715 -0.6399521
## 33 SNP.39 8.683451e-02 0.10305 0.0005409458 1.7123374 0.9765224 -0.4442242
## 34  SNP.4 6.405700e-01 0.09815 0.0005648659 0.4669020 0.9755097 -1.7484094
## 35 SNP.40 6.484958e-02 0.10250 0.0005435152 1.8462937 0.9764135 -0.2093416
## 36 SNP.41 2.037508e-02 0.09920 0.0005595385 2.3193681 0.9757351  0.7651068
## 37 SNP.42 9.122142e-02 0.10030 0.0005540786 1.6889896 0.9759661 -0.4720833
## 38 SNP.43 4.603796e-02 0.09995 0.0005558026 1.9950452 0.9758932  0.0794977
## 39 SNP.44 1.667411e-01 0.09820 0.0005646096 1.3827514 0.9755205 -0.9223618
## 40 SNP.45 1.620957e-01 0.09820 0.0005646096 1.3980579 0.9755205 -0.9016004
## 41 SNP.46 7.947087e-01 0.09780 0.0005666675 0.2602011 0.9754335 -1.8201649
## 42 SNP.47 7.250596e-01 0.09545 0.0005791106 0.3517048 0.9749076 -1.7822987
## 43 SNP.48 8.880387e-01 0.09555 0.0005785685 0.1407864 0.9749305 -1.8333895
## 44 SNP.49 5.762112e-01 0.09550 0.0005788394 0.5589274 0.9749190 -1.6905409
## 45  SNP.5 7.750356e-01 0.10050 0.0005530989 0.2857944 0.9760076 -1.8251500
## 46 SNP.50 5.055117e-01 0.09575 0.0005774877 0.6658426 0.9749761 -1.6278368
## 47  SNP.6 6.662985e-01 0.10155 0.0005480197 0.4312337 0.9762227 -1.7787416
## 48  SNP.7 4.738518e-01 0.10045 0.0005533434 0.7162260 0.9759973 -1.6144603
## 49  SNP.8 2.250692e-01 0.10120 0.0005497009 1.2131587 0.9761515 -1.1496895
## 50  SNP.9 3.281596e-01 0.10015 0.0005548159 0.9778276 0.9759349 -1.3969283
##     pvalues.df2 MAF.df2        V.df2       z.df2     r.df2   lABF.df2
## 1  2.697201e-01 0.09965 0.0005572901  1.10370733 0.9758302 -1.2669622
## 2  4.259334e-01 0.09795 0.0005658938  0.79616977 0.9754662 -1.5446846
## 3  1.963472e-01 0.10020 0.0005545699  1.29202861 0.9759453 -1.0491219
## 4  4.327978e-02 0.10005 0.0005553088  2.02099989 0.9759141  0.1299680
## 5  8.924884e-03 0.10105 0.0005504250  2.61491817 0.9761208  1.4698837
## 6  1.275277e-01 0.09965 0.0005572901  1.52392396 0.9758302 -0.7282188
## 7  4.330465e-02 0.09900 0.0005605444  2.02075968 0.9756925  0.1336204
## 8  2.948938e-02 0.09660 0.0005729448  2.17688190 0.9751681  0.4627572
## 9  5.353317e-03 0.10020 0.0005545699  2.78496699 0.9759453  1.9210229
## 10 3.613791e-03 0.10080 0.0005516367  2.91004294 0.9760695  2.2665480
## 11 2.793813e-04 0.09820 0.0005646096  3.63370402 0.9755205  4.5853313
## 12 7.672294e-02 0.09750 0.0005682222  1.77002520 0.9753678 -0.3239411
## 13 1.508395e-06 0.09820 0.0005646096  4.81012023 0.9755205  9.4304743
## 14 7.193883e-10 0.09615 0.0005753397  6.16176440 0.9750669 16.6645690
## 15 1.920357e-13 0.09770 0.0005671847  7.35422661 0.9754116 24.5246569
## 16 6.800009e-17 0.09925 0.0005592876  8.35045572 0.9757457 32.1598467
## 17 4.504524e-16 0.10170 0.0005473028  8.12416505 0.9762531 30.3472047
## 18 9.561723e-29 0.10205 0.0005456383 11.12424003 0.9763236 58.5377568
## 19 3.629748e-15 0.10170 0.0005473028  7.86709369 0.9762531 28.3405679
## 20 5.094567e-13 0.10100 0.0005506669  7.22275254 0.9761106 23.5937839
## 21 5.229864e-11 0.10145 0.0005484988  6.56424077 0.9762024 19.1628327
## 22 3.509618e-12 0.10355 0.0005386341  6.95564132 0.9766204 21.7469638
## 23 2.334262e-01 0.09760 0.0005677029  1.19157940 0.9753897 -1.1598362
## 24 1.152581e-09 0.10365 0.0005381744  6.08670487 0.9766399 16.2129030
## 25 1.668457e-09 0.10235 0.0005442208  6.02717949 0.9763836 15.8615840
## 26 1.201553e-07 0.10385 0.0005372579  5.29325943 0.9766787 11.8033883
## 27 8.644376e-07 0.10620 0.0005267507  4.92022732 0.9771244  9.9385827
## 28 6.491057e-06 0.10415 0.0005358897  4.50972875 0.9767367  8.0518266
## 29 8.429685e-05 0.10515 0.0005313865  3.93184376 0.9769277  5.6667942
## 30 1.132777e-03 0.10280 0.0005421103  3.25528729 0.9764731  3.2989868
## 31 2.122003e-03 0.10320 0.0005402499  3.07260338 0.9765519  2.7332772
## 32 6.085808e-02 0.10330 0.0005397871  1.87452516 0.9765715 -0.1611413
## 33 1.002420e-01 0.10305 0.0005409458  1.64368175 0.9765224 -0.5567243
## 34 3.039341e-01 0.09815 0.0005648659  1.02803353 0.9755097 -1.3392535
## 35 8.074011e-02 0.10250 0.0005435152  1.74640782 0.9764135 -0.3845395
## 36 1.677204e-01 0.09920 0.0005595385  1.37956568 0.9757351 -0.9308511
## 37 4.988797e-01 0.10030 0.0005540786  0.67625353 0.9759661 -1.6409819
## 38 3.293819e-01 0.09995 0.0005558026  0.97535965 0.9758932 -1.3984333
## 39 1.819521e-01 0.09820 0.0005646096  1.33476871 0.9755205 -0.9859627
## 40 3.355049e-01 0.09820 0.0005646096  0.96308493 0.9755205 -1.4025465
## 41 2.856107e-01 0.09780 0.0005666675  1.06780018 0.9754335 -1.2970923
## 42 3.505747e-02 0.09545 0.0005791106  2.10769400 0.9749076  0.3228572
## 43 7.838269e-01 0.09555 0.0005785685  0.27433532 0.9749305 -1.8063648
## 44 3.319422e-01 0.09550 0.0005788394  0.97020918 0.9749190 -1.3839747
## 45 9.435827e-01 0.10050 0.0005530989  0.07076757 0.9760076 -1.8625654
## 46 8.303231e-01 0.09575 0.0005774877  0.21428724 0.9749761 -1.8215779
## 47 9.647620e-01 0.10155 0.0005480197  0.04417869 0.9762227 -1.8685593
## 48 4.553555e-01 0.10045 0.0005533434  0.74651644 0.9759973 -1.5928384
## 49 9.590981e-01 0.10120 0.0005497009  0.05128539 0.9761515 -1.8667332
## 50 7.812250e-01 0.10015 0.0005548159  0.27772306 0.9759349 -1.8258598
##    internal.sum.lABF    SNP.PP.H4
## 1        -3.00130583 1.171867e-43
## 2        -3.31129529 8.595111e-44
## 3        -2.90654294 1.288348e-43
## 4        -0.24678609 1.841412e-42
## 5        -0.29974649 1.746427e-42
## 6        -2.56880104 1.805979e-43
## 7         0.27230236 3.094483e-42
## 8        -0.02465471 2.299436e-42
## 9         3.85155851 1.109275e-40
## 10        7.63580923 4.881110e-39
## 11       12.72635565 7.930760e-37
## 12       -2.12427943 2.816864e-43
## 13       13.78216130 2.279530e-36
## 14       23.86673850 5.464137e-32
## 15       35.91141875 9.299503e-27
## 16       44.79205799 6.687632e-23
## 17       44.43433666 4.676447e-23
## 18       95.85125527 1.000000e+00
## 19       48.18527301 1.990338e-21
## 20       38.57797659 1.338231e-25
## 21       30.59615985 4.571641e-29
## 22       27.81177547 2.823770e-30
## 23       -2.95189389 1.231225e-43
## 24       20.01698891 1.163045e-33
## 25       19.67652951 8.274408e-34
## 26       16.79261617 4.626678e-35
## 27       12.70230927 7.742328e-37
## 28        9.87406936 4.577018e-38
## 29        6.89880046 2.335822e-39
## 30        2.06624213 1.860743e-41
## 31        1.13723519 7.348923e-42
## 32       -0.80109331 1.057836e-42
## 33       -1.00094845 8.662083e-43
## 34       -3.08766289 1.074914e-43
## 35       -0.59388117 1.301396e-42
## 36       -0.16574429 1.996857e-42
## 37       -2.11306520 2.848631e-43
## 38       -1.31893560 6.302637e-43
## 39       -1.90832449 3.495859e-43
## 40       -2.30414696 2.353155e-43
## 41       -3.11725719 1.043569e-43
## 42       -1.45944148 5.476478e-43
## 43       -3.63975430 6.188759e-44
## 44       -3.07451562 1.089140e-43
## 45       -3.68771536 5.898945e-44
## 46       -3.44941476 7.486295e-44
## 47       -3.64730084 6.142231e-44
## 48       -3.20729870 9.537106e-44
## 49       -3.01642262 1.154285e-43
## 50       -3.22278805 9.390521e-44
## 
## $priors
##    p1    p2   p12 
## 1e-04 1e-04 1e-05 
## 
## attr(,"class")
## [1] "coloc_abf" "list"</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#fine-mapping-under-a-single-causal-variant-assumption">Fine mapping under a single causal variant assumption</a></li>
      <li>
<a href="#approximate-bayes-factor-colocalisation-analyses">(Approximate) Bayes Factor colocalisation analyses</a><ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#the-basic-coloc-abf-function">The basic <code>coloc.abf</code> function</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Chris Wallace, Claudia Giambartolomei.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
