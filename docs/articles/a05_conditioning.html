<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>DEPRECATED Coloc: relaxing the single causal variant assumption • coloc</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="DEPRECATED Coloc: relaxing the single causal variant assumption">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">coloc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">6.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/a01_intro.html">Coloc: a package for colocalisation analyses</a></li>
    <li><a class="dropdown-item" href="../articles/a02_data.html">Coloc: data structures</a></li>
    <li><a class="dropdown-item" href="../articles/a03_enumeration.html">Coloc: under a single causal variant assumption</a></li>
    <li><a class="dropdown-item" href="../articles/a04_sensitivity.html">Coloc: sensitivity to prior values</a></li>
    <li><a class="dropdown-item" href="../articles/a06_SuSiE.html">Coloc: using SuSiE to relax the single causal variant assumption</a></li>
    <li><a class="dropdown-item" href="../articles/a07_variant-specific-priors.html">Coloc: using variant-specific priros in coloc</a></li>
    <li><a class="dropdown-item" href="../articles/a05_conditioning.html">DEPRECATED Coloc: relaxing the single causal variant assumption</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/chr1swallace/coloc/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>DEPRECATED Coloc: relaxing the single causal variant assumption</h1>
                        <h4 data-toc-skip class="author">Chris
Wallace</h4>
            
            <h4 data-toc-skip class="date">2025-11-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/chr1swallace/coloc/blob/HEAD/vignettes/a05_conditioning.Rmd" class="external-link"><code>vignettes/a05_conditioning.Rmd</code></a></small>
      <div class="d-none name"><code>a05_conditioning.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="multiple-causal-variants">Multiple causal variants<a class="anchor" aria-label="anchor" href="#multiple-causal-variants"></a>
</h2>
<p><em>This describes deprecated functions - the <a href="a06_SuSiE.html">SuSiE approach</a> is more accurate and should be
used instead</em></p>
<p>We load some simulated data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/chr1swallace/coloc" class="external-link">coloc</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## This is coloc version 6.0.0</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">coloc_test_data</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/attach.html" class="external-link">attach</a></span><span class="op">(</span><span class="va">coloc_test_data</span><span class="op">)</span> <span class="co"># contains D3, D4 that we will use in this vignette</span></span></code></pre></div>
<p>First, let us do a standard coloc (single causal variant) analysis to
serve as a baseline comparison. The analysis concludes there is
colocalisation, because it “sees” the SNPs on the left which are
strongly associated with both traits. But it misses the SNPs on the
right of the top left plot which are associated with only one trait.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/chr1swallace/coloc" class="external-link">coloc</a></span><span class="op">)</span></span>
<span><span class="va">my.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/coloc.abf.html">coloc.abf</a></span><span class="op">(</span>dataset1<span class="op">=</span><span class="va">D3</span>, dataset2<span class="op">=</span><span class="va">D4</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## PP.H0.abf PP.H1.abf PP.H2.abf PP.H3.abf PP.H4.abf </span></span>
<span><span class="co">##  8.78e-26  6.80e-07  1.53e-22  1.85e-04  1.00e+00 </span></span>
<span><span class="co">## [1] "PP abf for shared variant: 100%"</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">my.res</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "coloc_abf" "list"</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## print.coloc_abf</span></span>
<span><span class="va">my.res</span></span></code></pre></div>
<pre><code><span><span class="co">## Coloc analysis of trait 1, trait 2</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## SNP Priors</span></span></code></pre>
<pre><code><span><span class="co">##    p1    p2   p12 </span></span>
<span><span class="co">## 1e-04 1e-04 1e-05</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Hypothesis Priors</span></span></code></pre>
<pre><code><span><span class="co">##        H0   H1   H2       H3    H4</span></span>
<span><span class="co">##  0.892505 0.05 0.05 0.002495 0.005</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Posterior</span></span></code></pre>
<pre><code><span><span class="co">##        nsnps           H0           H1           H2           H3           H4 </span></span>
<span><span class="co">## 5.000000e+02 8.775708e-26 6.797736e-07 1.529399e-22 1.848705e-04 9.998144e-01</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sensitivity.html">sensitivity</a></span><span class="op">(</span><span class="va">my.res</span>,<span class="st">"H4 &gt; 0.9"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Results pass decision rule H4 &gt; 0.9</span></span></code></pre>
<p><img src="a05_conditioning_files/figure-html/sens0-1.png" width="768"></p>
<p>Even though the sensitivity analysis itself looks good, the Manhattan
plots suggest we are violating the assumption of a single causal variant
per trait.<br>
We can use =finemap.signals= to test whether there are additional
signals after conditioning.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/finemap.signals.html">finemap.signals</a></span><span class="op">(</span><span class="va">D3</span>,method<span class="op">=</span><span class="st">"cond"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      s105       s78 </span></span>
<span><span class="co">## 11.180489  5.351394</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/finemap.signals.html">finemap.signals</a></span><span class="op">(</span><span class="va">D4</span>,method<span class="op">=</span><span class="st">"cond"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    s105 </span></span>
<span><span class="co">## 6.42341</span></span></code></pre>
<p>Note that every colocalisation conditions out every other signal
except one for each trait. For that reason, trying to colocalise many
signals per trait is not recommended. Instead, use pthr to set the
significance (p value) required to call a signal. If you set if too low,
you will capture signals that are non-significant, or too high and you
will miss true signals. pthr=5e-8 would correspond to a genome-wide
significance level for common variants in a European study, but we
typically choose a slightly relaxed pthr=1e-6 on the basis that if there
is one GW-significant signal in a region, we expect there is a greater
chance for secondary signals to exist.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/finemap.signals.html">finemap.signals</a></span><span class="op">(</span><span class="va">D3</span>,method<span class="op">=</span><span class="st">"cond"</span>,pthr<span class="op">=</span><span class="fl">1e-20</span><span class="op">)</span> <span class="co">## too small</span></span></code></pre></div>
<pre><code><span><span class="co">##     s105 </span></span>
<span><span class="co">## 11.18049</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/finemap.signals.html">finemap.signals</a></span><span class="op">(</span><span class="va">D4</span>,method<span class="op">=</span><span class="st">"cond"</span>,pthr<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="co">## too big</span></span></code></pre></div>
<pre><code><span><span class="co">##      s105      s108      s156 </span></span>
<span><span class="co">##  6.423410 -3.226812  3.741284</span></span></code></pre>
<p>Now we can ask coloc to consider these as separate signals using the
coloc.signals() function.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/coloc.signals.html">coloc.signals</a></span><span class="op">(</span><span class="va">D3</span>,<span class="va">D4</span>,method<span class="op">=</span><span class="st">"cond"</span>,p12<span class="op">=</span><span class="fl">1e-6</span>,pthr<span class="op">=</span><span class="fl">1e-6</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## PP.H0.abf PP.H1.abf PP.H2.abf PP.H3.abf PP.H4.abf </span></span>
<span><span class="co">##  8.76e-25  6.79e-06  1.53e-21  1.85e-03  9.98e-01 </span></span>
<span><span class="co">## [1] "PP abf for shared variant: 99.8%"</span></span>
<span><span class="co">## PP.H0.abf PP.H1.abf PP.H2.abf PP.H3.abf PP.H4.abf </span></span>
<span><span class="co">##  1.83e-05  5.53e-04  3.19e-02  9.64e-01  3.52e-03 </span></span>
<span><span class="co">## [1] "PP abf for shared variant: 0.352%"</span></span>
<span><span class="co">## PP.H0.abf PP.H1.abf PP.H2.abf PP.H3.abf PP.H4.abf </span></span>
<span><span class="co">##  5.44e-04  2.33e-05  9.49e-01  4.04e-02  1.02e-02 </span></span>
<span><span class="co">## [1] "PP abf for shared variant: 1.02%"</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span></span></code></pre></div>
<pre><code><span><span class="co">## Coloc analysis of trait 1, trait 2</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## SNP Priors</span></span></code></pre>
<pre><code><span><span class="co">##    p1    p2   p12 </span></span>
<span><span class="co">## 1e-04 1e-04 1e-06</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Hypothesis Priors</span></span></code></pre>
<pre><code><span><span class="co">##        H0   H1   H2       H3    H4</span></span>
<span><span class="co">##  0.897005 0.05 0.05 0.002495 5e-04</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Posterior</span></span></code></pre>
<pre><code><span><span class="co">## Key: &lt;hit2&gt;</span></span>
<span><span class="co">##    nsnps   hit1   hit2           H0           H1           H2         H3</span></span>
<span><span class="co">##    &lt;int&gt; &lt;char&gt; &lt;char&gt;        &lt;num&gt;        &lt;num&gt;        &lt;num&gt;      &lt;num&gt;</span></span>
<span><span class="co">## 1:   500   s105   s105 8.674493e-25 6.719334e-06 1.511759e-21 0.01171021</span></span>
<span><span class="co">## 2:   500    s78   s105 1.830995e-05 5.531424e-04 3.190992e-02 0.96399665</span></span>
<span><span class="co">##             H4</span></span>
<span><span class="co">##          &lt;num&gt;</span></span>
<span><span class="co">## 1: 0.988283067</span></span>
<span><span class="co">## 2: 0.003521974</span></span></code></pre>
<p>Note that because we are doing multiple colocalisations,
sensitivity() needs to know which to consider:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sensitivity.html">sensitivity</a></span><span class="op">(</span><span class="va">res</span>,<span class="st">"H4 &gt; 0.9"</span>,row<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Results pass decision rule H4 &gt; 0.9</span></span></code></pre>
<p><img src="a05_conditioning_files/figure-html/sens-1.png" width="768"></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sensitivity.html">sensitivity</a></span><span class="op">(</span><span class="va">res</span>,<span class="st">"H4 &gt; 0.9"</span>,row<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Results fail decision rule H4 &gt; 0.9</span></span></code></pre>
<p><img src="a05_conditioning_files/figure-html/sens-2.png" width="768"></p>
<!-- Because these signals are truly independent, we could also split them by using masking, which doesn't condition at all, but restricts the search space for colocalisation to SNPs which are not in LD with any-but-one of each signal SNP.  Here you also need to consider r2thr which sets the maximum \(r^2\) between two SNPs for them to be considered independent. -->
<!-- ```{r , fig.width=8,fig.height=6   } -->
<!-- finemap.signals(D3,method="mask",r2thr=0.3) -->
<!-- finemap.signals(D4,method="mask",r2thr=0.3) -->
<!-- resm=coloc.signals(D3,D4,method="mask",p12=1e-6,pthr=1e-6,r2thr=0.01) -->
<!-- resm -->
<!-- sensitivity(resm,"H4 > 0.9",row=1) -->
<!-- sensitivity(resm,"H4 > 0.9",row=2) -->
<!-- ``` -->
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Chris Wallace, Claudia Giambartolomei, Tom Willis, Jeffrey Pullin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
