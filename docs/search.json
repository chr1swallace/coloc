[{"path":"https://chr1swallace.github.io/coloc/FAQ.html","id":null,"dir":"","previous_headings":"","what":"If I understand correctly, coloc.abf() can be run with correlated variants, that is, no prerequisite for taking through LD pruning/clumping is required. Am I correct in my understanding ?","title":"If I understand correctly, coloc.abf() can be run with correlated variants, that is, no prerequisite for taking through LD pruning/clumping is required. Am I correct in my understanding ?","text":"Yes, coloc.abf() coloc.signals() assume given dense map SNPs region causal. prune clump.","code":""},{"path":"https://chr1swallace.github.io/coloc/FAQ.html","id":"assume-i-identify-a-sentinel-variant-for-a-block-of-genome-can-i-do-a-comparison-with-just-one-variant-using-colocabf","dir":"","previous_headings":"","what":"Assume I identify a sentinel variant for a block of genome, can I do a comparison with just one variant using coloc.abf()?","title":"If I understand correctly, coloc.abf() can be run with correlated variants, that is, no prerequisite for taking through LD pruning/clumping is required. Am I correct in my understanding ?","text":", coloc.abf() coloc.signals() assume given dense map SNPs region causal. means need give SNPs region. can imagine ask whether patterns “match” across region SNPs, single variant represent pattern.","code":""},{"path":"https://chr1swallace.github.io/coloc/FAQ.html","id":"can-the-process-of-identifying-colocalized-variants-be-carried-out-genome-wide","dir":"","previous_headings":"","what":"Can the process of identifying colocalized variants be carried out genome wide?","title":"If I understand correctly, coloc.abf() can be run with correlated variants, that is, no prerequisite for taking through LD pruning/clumping is required. Am I correct in my understanding ?","text":"Coloc designed address whether two traits share causal variant(s) genomic region. leaves definition “region” user. need break genome smaller regions, within reasonable assume one (coloc.abf) small number (coloc.signals) causal variants per trait. One way use boundaries defined recombination hotspots, proxied map created lddetect. big region ? Big enough variants LD lead SNP included; small enough one small number causal variants might exist . found using densely genotyped studies lddetect boundaries regions typically contain 1,000-10,000 SNPs.","code":""},{"path":"https://chr1swallace.github.io/coloc/FAQ.html","id":"how-is-colocabf-accounting-for-the-correlated-variants","dir":"","previous_headings":"","what":"How is coloc.abf accounting for the correlated variants?","title":"If I understand correctly, coloc.abf() can be run with correlated variants, that is, no prerequisite for taking through LD pruning/clumping is required. Am I correct in my understanding ?","text":"’s really coloc works - exploiting dense SNP map - please see original paper","code":""},{"path":"https://chr1swallace.github.io/coloc/FAQ.html","id":"how-to-define-priors-is-it-dependent-on-sample-size-or-any-other-parameters","dir":"","previous_headings":"","what":"How to define priors, is it dependent on sample size or any other parameters?","title":"If I understand correctly, coloc.abf() can be run with correlated variants, that is, no prerequisite for taking through LD pruning/clumping is required. Am I correct in my understanding ?","text":"described detail latest paper","code":""},{"path":"https://chr1swallace.github.io/coloc/FAQ.html","id":"what-does-high-pp4-mean","dir":"","previous_headings":"","what":"What does high PP4 mean?","title":"If I understand correctly, coloc.abf() can be run with correlated variants, that is, no prerequisite for taking through LD pruning/clumping is required. Am I correct in my understanding ?","text":"summary printed screen coloc.abf() coloc.signals() shows posterior probability whether shared causal variant exists region. High PP4 mean variants causal shared - check variants likely causal look SNP.PP column returned detailed results data.frame.","code":""},{"path":"https://chr1swallace.github.io/coloc/FAQ.html","id":"i-have-a-question-how-should-we-interpret-a-high-overall-pp4-95-but-a-low-pp4-for-single-snp-50-in-colocabf-in-this-scenario-pp0-pp3-were-small-than-00001","dir":"","previous_headings":"","what":"I have a question. How should we interpret a high overall PP4 (>95%) but a low PP4 for single SNP (<50%) in coloc.abf? In this scenario, PP0-PP3 were small than 0.0001.","title":"If I understand correctly, coloc.abf() can be run with correlated variants, that is, no prerequisite for taking through LD pruning/clumping is required. Am I correct in my understanding ?","text":"high overall PP4 (>95%) means high probability colocalisation low PP4 single SNP (<50%) means identify individual SNP jointly causal confidence","code":""},{"path":"https://chr1swallace.github.io/coloc/articles/a01_intro.html","id":"a-brief-outline-of-colocalisation-analysis","dir":"Articles","previous_headings":"","what":"A brief outline of colocalisation analysis","title":"Coloc: a package for colocalisation analyses","text":"coloc package can used perform genetic colocalisation analysis two potentially related phenotypes, ask whether share common genetic causal variant(s) given region. key references vignette duplicate (see ). brief, two approaches can implemented. proportional testing approach 12 now moved package, coloc.prop. package implements population enumeration approach. can read prepare data vignette read vignettes listed one sections understand coloc works.","code":""},{"path":"https://chr1swallace.github.io/coloc/articles/a01_intro.html","id":"a-single-causal-variant-assumption","dir":"Articles","previous_headings":"A brief outline of colocalisation analysis","what":"A single causal variant assumption","title":"Coloc: a package for colocalisation analyses","text":"Claudia Giambartolomei Vincent Plagnol proposed enumeration method, makes use Jon Wakefield’s work determining approximate Bayes Factors p values 3 generate colocalisation analysis 4, implemented function coloc.abf(). assuming one causal variant per trait, every possible configuration can individually enumerated evaluated, aggregating allows us gauge relative support models support colocalisation don’t. can see enumeration approach blogpost. See vignette: enumeration","code":""},{"path":"https://chr1swallace.github.io/coloc/articles/a01_intro.html","id":"sensitivity-analysis","dir":"Articles","previous_headings":"A brief outline of colocalisation analysis","what":"Sensitivity analysis","title":"Coloc: a package for colocalisation analyses","text":"Bayesian method, coloc.abf() requires user specify prior probabilities SNP causality colocalisation. Post-hoc sensitivity analysis can used assess whether results robust across range plausible priors. See vignette: sensitivity","code":""},{"path":"https://chr1swallace.github.io/coloc/articles/a01_intro.html","id":"deprecated-relaxing-the-single-causal-variant-assumption-through-conditioning","dir":"Articles","previous_headings":"A brief outline of colocalisation analysis","what":"Deprecated: relaxing the single causal variant assumption through conditioning","title":"Coloc: a package for colocalisation analyses","text":"single variant assumption can relaxed conditioning. implemented conditioning step within coloc, hope increase use conditioning, proposed alternative, masking. See vignette: conditioning/masking","code":""},{"path":"https://chr1swallace.github.io/coloc/articles/a01_intro.html","id":"an-improved-approach-to-relaxing-the-single-causal-variant-assumption-susie","dir":"Articles","previous_headings":"A brief outline of colocalisation analysis","what":"An improved approach to relaxing the single causal variant assumption: SuSiE","title":"Coloc: a package for colocalisation analyses","text":"sum single effects regression method proposed Wang et al 6 can instead simultaneously decompose multiple signals marginal summary stats, appears work better conditioning. See vignette: SuSiE","code":""},{"path":"https://chr1swallace.github.io/coloc/articles/a01_intro.html","id":"footnotes","dir":"Articles","previous_headings":"","what":"Footnotes","title":"Coloc: a package for colocalisation analyses","text":"1https://pubmed.ncbi.nlm.nih.gov/19039033/ 2https://doi.org/10.1002/gepi.21765 3https://pubmed.ncbi.nlm.nih.gov/18642345/ 4https://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1004383 5https://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1005272 6https://rss.onlinelibrary.wiley.com/doi/10.1111/rssb.12388","code":""},{"path":"https://chr1swallace.github.io/coloc/articles/a02_data.html","id":"data-structures","dir":"Articles","previous_headings":"","what":"Data structures","title":"Coloc: data structures","text":"enumeration approaches coloc coloc.abf coloc.susie require data format. flexible, coloc.abf allows wider variety inputs, can sometimes confusing. document aims set ideal acceptable data structures , well covering points select SNPs study.","code":""},{"path":"https://chr1swallace.github.io/coloc/articles/a02_data.html","id":"first-select-the-snps-to-study-","dir":"Articles","previous_headings":"Data structures","what":"First: select the SNPs to study.","title":"Coloc: data structures","text":"dataset must represent genetic association statistics single trait single genomic region. means , example, supply coloc whole genome whole chromosome test statistics merge eQTL summary stats across multiple genes SNPs must summary data available studies cover single genomic region (perhaps defined distance GWAS peak delimited recombination hotspots), represent dense coverage region (don’t threshold p value) can result 10,000 SNPs larger regions. single genomic region correspond whole genome, whole chromosome. Coloc also automatically split chromosomes genome regions. assumed user can look data, identify region overlapping GWAS signals two studies, decide set SNPs include. utilities provided can help check regions sensible. Please include SNPs region: trim significance MAF means. Coloc enumerates possible configureations shared non-shared causal variants evaluates relative support; SNPs available.","code":""},{"path":"https://chr1swallace.github.io/coloc/articles/a02_data.html","id":"a-minimum-coloc-dataset","dir":"Articles","previous_headings":"Data structures","what":"A minimum coloc dataset","title":"Coloc: data structures","text":"Colocalisation fine-mapping work evaluating approximate Bayes factors summarising evidence association SNP. requires knowing estimated effect size β\\beta (beta) uncertainty var(β)var(\\beta) (varbeta). var(β)var(\\beta) standard error β\\beta, squared. also good practice supply SNP names (snp), SNP positions (position) useful want use coloc’s plot_dataset(). also need prior true effect sizes causal variants, different depending whether quantitative case-control (binary) trait. estimate prior, need know trait standard deviation (allows us interpret scale estimated beta). minimum coloc dataset list, containing mix vectors (values vary across snps, effect sizes beta variance beta varbeta) scalars (values assumed constant across snps, sample size [N] data type [type=\"cc\" case control type=\"quant\" quantitative]). See ?check_dataset full set entries, combination compulsory. can useful run check_dataset() datasets coloc functions aren’t running. return NULL finds errors. stop error issues absolutely must fixed run coloc, may print warnings sees something merely suspicious - eg strong signal association. Coloc comes test data, can explore structure quantitative trait. show minimum dataset needed quantitative trait. see (str) minimum_data list. vector entries beta, varbeta, snp position, length (number snps region) scalar entries type sdY (standard deviation quantitative trait). check_dataset() issues warning minimum p value exceeds warn.minp. (default value warn.minp 10^{-6}). warning doesn’t mean can’t run coloc - perfectly valid assess evidence association one datasets, may alert check something thought strong association . One common mistake use standard error beta place variance beta. dataset provides standard error, simply square get variance. ’s also useful plot datasets, check coverage dense level association matches expectation  case control trait, need give type “cc”: either case, can see lengths beta, varbeta, snp position . assumed represent snps order. data data.frame, use .list() convert list, add elements, pass data.frame coloc, elements like type need length 1.","code":"library(coloc) ## This is coloc version 6.0.1 data(coloc_test_data) attach(coloc_test_data) minimum_data=D1[c(\"beta\",\"varbeta\",\"snp\",\"position\",\"type\",\"sdY\")] str(minimum_data) ## List of 6 ##  $ beta    : num [1:500] 0.337 0.211 0.257 0.267 0.247 ... ##  $ varbeta : num [1:500] 0.01634 0.00532 0.00748 0.01339 0.00664 ... ##  $ snp     : chr [1:500] \"s1\" \"s2\" \"s3\" \"s4\" ... ##  $ position: int [1:500] 1 2 3 4 5 6 7 8 9 10 ... ##  $ type    : chr \"quant\" ##  $ sdY     : num 1.1 check_dataset(minimum_data,warn.minp=1e-10) ## NULL plot_dataset(minimum_data) minimum_ccdata=D1[c(\"beta\",\"varbeta\",\"snp\",\"position\")] minimum_ccdata$type=\"cc\" str(minimum_ccdata) ## List of 5 ##  $ beta    : num [1:500] 0.337 0.211 0.257 0.267 0.247 ... ##  $ varbeta : num [1:500] 0.01634 0.00532 0.00748 0.01339 0.00664 ... ##  $ snp     : chr [1:500] \"s1\" \"s2\" \"s3\" \"s4\" ... ##  $ position: int [1:500] 1 2 3 4 5 6 7 8 9 10 ... ##  $ type    : chr \"cc\" check_dataset(minimum_ccdata) ## NULL"},{"path":"https://chr1swallace.github.io/coloc/articles/a02_data.html","id":"analysing-two-datasets","dir":"Articles","previous_headings":"Data structures","what":"Analysing two datasets","title":"Coloc: data structures","text":"coloc used analyse exactly two datasets. snp identifiers used match snps datasets, snps appear datasets contribute analysis. useful plot pair datasets, check shared snps cover peaks either dataset.  shared copies dataset. snps coloured blue unique one dataset .","code":"plot_datasets(minimum_data, minimum_ccdata) short_data1=lapply(D1[c(\"beta\",\"varbeta\",\"snp\",\"position\")], \"[\", 200:500) short_data2=lapply(D1[c(\"beta\",\"varbeta\",\"snp\",\"position\")], \"[\", 1:400) short_data1$type=\"cc\" short_data2$type=\"cc\" check_dataset(short_data1) ## NULL check_dataset(short_data2) ## NULL plot_datasets(short_data1, short_data2)"},{"path":"https://chr1swallace.github.io/coloc/articles/a02_data.html","id":"what-if-i-dont-have-sdy","dir":"Articles","previous_headings":"Data structures","what":"What if I don’t have sdY?","title":"Coloc: data structures","text":"Often, sdY available quantitative datasets. study say standardised trait variance 1, can set =sdY= 1. Otherwise coloc can estimate , needs MAF sample size information . dataset look like:","code":"nosdY_data=D1[c(\"beta\",\"varbeta\",\"snp\",\"position\",\"type\",\"N\",\"MAF\")] str(nosdY_data) ## List of 7 ##  $ beta    : num [1:500] 0.337 0.211 0.257 0.267 0.247 ... ##  $ varbeta : num [1:500] 0.01634 0.00532 0.00748 0.01339 0.00664 ... ##  $ snp     : chr [1:500] \"s1\" \"s2\" \"s3\" \"s4\" ... ##  $ position: int [1:500] 1 2 3 4 5 6 7 8 9 10 ... ##  $ type    : chr \"quant\" ##  $ N       : int 1000 ##  $ MAF     : num [1:500] 0.031 0.166 0.0925 0.0405 0.118 ... check_dataset(nosdY_data) ## NULL"},{"path":"https://chr1swallace.github.io/coloc/articles/a02_data.html","id":"what-if-i-dont-have-beta-andor-varbeta","dir":"Articles","previous_headings":"Data structures","what":"What if I don’t have beta and/or varbeta?","title":"Coloc: data structures","text":"beta varbeta preferred. Please supply , especially case imputed data capture effects imperfect imputation. don’t , coloc can estimate , given p values, MAF, sample size , case-control data, fraction samples cases: Note coloc doesn’t mind dataset entries minimally needs, use needs, preferring supplied beta/varbeta sdY estimation, leave rest.","code":"nobeta_data=D1[c(\"MAF\",\"snp\",\"position\",\"type\",\"sdY\",\"N\")] nobeta_data$pvalues=pnorm(-abs(D1$beta/sqrt(D1$varbeta)))*2 str(nobeta_data) ## List of 7 ##  $ MAF     : num [1:500] 0.031 0.166 0.0925 0.0405 0.118 ... ##  $ snp     : chr [1:500] \"s1\" \"s2\" \"s3\" \"s4\" ... ##  $ position: int [1:500] 1 2 3 4 5 6 7 8 9 10 ... ##  $ type    : chr \"quant\" ##  $ sdY     : num 1.1 ##  $ N       : int 1000 ##  $ pvalues : num [1:500] 0.0083 0.00385 0.00294 0.02088 0.00242 ... check_dataset(nobeta_data) ## NULL nobeta_ccdata=D1[c(\"MAF\",\"snp\",\"position\",\"N\")] nobeta_ccdata$pvalues=pnorm(-abs(D1$beta/sqrt(D1$varbeta)))*2 nobeta_ccdata$type=\"cc\" nobeta_ccdata$s=0.5 str(nobeta_ccdata) ## List of 7 ##  $ MAF     : num [1:500] 0.031 0.166 0.0925 0.0405 0.118 ... ##  $ snp     : chr [1:500] \"s1\" \"s2\" \"s3\" \"s4\" ... ##  $ position: int [1:500] 1 2 3 4 5 6 7 8 9 10 ... ##  $ N       : int 1000 ##  $ pvalues : num [1:500] 0.0083 0.00385 0.00294 0.02088 0.00242 ... ##  $ type    : chr \"cc\" ##  $ s       : num 0.5 check_dataset(nobeta_ccdata) ## NULL"},{"path":"https://chr1swallace.github.io/coloc/articles/a02_data.html","id":"additional-ld-information-for-coloc-susie","dir":"Articles","previous_headings":"Data structures","what":"Additional LD information for coloc.susie","title":"Coloc: data structures","text":"coloc.abf makes simplifying assumption trait one causal variant region consideration. means need know correlation (LD) SNPs, model consideration two SNPs . coloc.susie extends functionality allowing one causal variant, means needs know LD SNPs. may able get study data, , reference data 1000 Genomes can used. test data LD matrix already. square numeric matrix dimension equal number SNPs, dimnames corresponding SNP ids.","code":"str(D1$LD) ##  num [1:500, 1:500] 1 0.365 0.54 0.851 0.463 ... ##  - attr(*, \"dimnames\")=List of 2 ##   ..$ : chr [1:500] \"s1\" \"s2\" \"s3\" \"s4\" ... ##   ..$ : chr [1:500] \"s1\" \"s2\" \"s3\" \"s4\" ..."},{"path":"https://chr1swallace.github.io/coloc/articles/a02_data.html","id":"nb-studies-from-different-populations","dir":"Articles","previous_headings":"Data structures > Additional LD information for coloc.susie","what":"NB studies from different populations","title":"Coloc: data structures","text":"One nice things coloc.abf assume LD structures similar studies, long dense map SNPs across region. thing still applies coloc.susie, just add appropriate LD matrix study.","code":""},{"path":"https://chr1swallace.github.io/coloc/articles/a02_data.html","id":"nb-allele-order-matters","dir":"Articles","previous_headings":"Data structures > Additional LD information for coloc.susie","what":"NB allele order matters!","title":"Coloc: data structures","text":"beta coefficients GWAS studies report effect one allele respect . , see results looking like beta telling effect allele compared allele G snp rs908742. alleles reversed, beta -0.0826. LD matrix needs aligned way. easy GWAS data making LD matrix . get public source, almost certainly telling LD non-reference alleles. case, need make sure data also listing non-reference allele “alternative” “risk” allele. , switch sign beta. avoid hassles, recommend: * using GWAS catalog data, download harmonised version . * using eQTL summary data processed eQTL catalogue, use version also harmonised * Otherwise, check alleles summary table match information files LD source * Finally, always plot coloc result sensitivity function weird effects much easier understand visually can also use coloc function check_alignment visual guide. compares product Z scores SNP pairs correlation, plots histogram ratio SNPs degree LD. expect see strongly negative products Z scores strongly positive correlations vice versa. Therefore plot skewed positive values negative. show good (left) bad (right) example.","code":"par(mfrow=c(1,2)) check_alignment(goodD) ## [1] 0.9061496 text(40,200,\"good\",col=\"red\",cex=4) check_alignment(badD) ## [1] 0.4999569 text(0,200,\"bad\",col=\"red\",cex=4)"},{"path":"https://chr1swallace.github.io/coloc/articles/a03_enumeration.html","id":"fine-mapping-under-a-single-causal-variant-assumption","dir":"Articles","previous_headings":"","what":"Fine mapping under a single causal variant assumption","title":"Coloc: under a single causal variant assumption","text":"Approximate Bayes Factor colocalisation analysis described next section essentially works fine mapping trait single causal variant assumption integrating two posterior distributions calculate probabilities variants shared. course, means can look trait quite simply, can function finemap.abf. First load simulated data. See data vignette understand format datasets. analyse statistics single study, asking evidence SNP turn solely causal association signal see. might expect, evidence maximised SNP smallest p value  SNP.PP column shows posterior probability exactly SNP causal. Note last line data.frame correspond SNP, null model, SNP causal. Finally, full genotype data , fast method fine mapping, can sensible consider multiple causal variant models . One package allows GUESSFM, described in5","code":"library(coloc) ## This is coloc version 6.0.1 data(coloc_test_data) attach(coloc_test_data) plot_dataset(D1) my.res <- finemap.abf(dataset=D1) my.res[21:30,] ##             V.       z.        r.       lABF. snp position prior       SNP.PP ## 21 0.006158578 3.105184 0.8155100  3.08656163 s21       21 1e-04 1.026731e-11 ## 22 0.006047354 3.010816 0.8182363  2.85613791 s22       22 1e-04 8.154269e-12 ## 23 0.017869410 1.247449 0.6037164  0.00691776 s23       23 1e-04 4.720461e-13 ## 24 0.005427008 3.746694 0.8337827  4.95497248 s24       24 1e-04 6.651159e-11 ## 25 0.005699008 3.168342 0.8268940  3.27341820 s25       25 1e-04 1.237678e-11 ## 26 0.004712835 5.305229 0.8524283 11.03926980 s26       26 1e-04 2.919269e-08 ## 27 0.006988649 2.570785 0.7957235  1.83530152 s27       27 1e-04 2.937930e-12 ## 28 0.004730114 5.483924 0.8519673 11.85562507 s28       28 1e-04 6.604085e-08 ## 29 0.004929736 4.771115 0.8466779  8.69908643 s29       29 1e-04 2.811547e-09 ## 30 0.005566298 3.176653 0.8302407  3.30234473 s30       30 1e-04 1.274002e-11 tail(my.res,3)"},{"path":[]},{"path":"https://chr1swallace.github.io/coloc/articles/a03_enumeration.html","id":"introduction","dir":"Articles","previous_headings":"(Approximate) Bayes Factor colocalisation analyses","what":"Introduction","title":"Coloc: under a single causal variant assumption","text":"idea behind ABF analysis association trait SNPs region may summarised vector 0s single 1, 1 indicating causal SNP (, assuming single causal SNP trait). posterior probability possible configuration can calculated , crucially, can posterior probabilities traits share configurations. allows us estimate support following cases: H0H_0: neither trait genetic association region H1H_1: trait 1 genetic association region H2H_2: trait 2 genetic association region H3H_3: traits associated, different causal variants H4H_4: traits associated share single causal variant","code":""},{"path":"https://chr1swallace.github.io/coloc/articles/a03_enumeration.html","id":"the-basic-coloc-abf-function","dir":"Articles","previous_headings":"(Approximate) Bayes Factor colocalisation analyses","what":"The basic coloc.abf function","title":"Coloc: under a single causal variant assumption","text":"function coloc.abf ideally suited case summary data available. Note find strong evidence H4, can extract posterior probabilities SNP causal conditional H4 true. part calculation required coloc, contained column SNP.PP.H4 “results” element returned list. can extract likely causal variants 95% credible set ","code":"my.res <- coloc.abf(dataset1=D1,                     dataset2=D2) ## PP.H0.abf PP.H1.abf PP.H2.abf PP.H3.abf PP.H4.abf  ##  1.38e-18  2.94e-10  8.59e-12  8.34e-04  9.99e-01  ## [1] \"PP abf for shared variant: 99.9%\" print(my.res) ## Coloc analysis of trait 1, trait 2 ##  ## SNP Priors ##    p1    p2   p12  ## 1e-04 1e-04 1e-05 ##  ## Hypothesis Priors ##        H0   H1   H2       H3    H4 ##  0.892505 0.05 0.05 0.002495 0.005 ##  ## Posterior ##        nsnps           H0           H1           H2           H3           H4  ## 5.000000e+02 1.377000e-18 2.937336e-10 8.593226e-12 8.338917e-04 9.991661e-01 subset(my.res$results,SNP.PP.H4>0.01) ##    snp position       V.df1    z.df1     r.df1 lABF.df1       V.df2    z.df2 ## 6 s103      103 0.004846592 7.780900 0.8488730 24.75159 0.004102488 7.560002 ## 8 s105      105 0.004808487 8.302463 0.8498828 28.34342 0.004100753 7.699676 ##       r.df2 lABF.df2 internal.sum.lABF  SNP.PP.H4 ## 6 0.8513388 23.37551           48.1271 0.01098066 ## 8 0.8513923 24.28418           52.6276 0.98894507 o <- order(my.res$results$SNP.PP.H4,decreasing=TRUE) cs <- cumsum(my.res$results$SNP.PP.H4[o]) w <- which(cs > 0.95)[1] my.res$results[o,][1:w,]$snp ## [1] \"s105\""},{"path":"https://chr1swallace.github.io/coloc/articles/a04_sensitivity.html","id":"sensitivity-analysis","dir":"Articles","previous_headings":"","what":"Sensitivity analysis","title":"Coloc: sensitivity to prior values","text":"Specifying prior values coloc.abf() important, results can dependent values. Defaults p1=p2=10−4p_1=p_2=10^{-4} seem justified wide range scenarios, broadly correspond 99% belief true association see p<5×10−8p<5\\times 10^{-8} GWAS. However, choice p12p_{12} difficult. hope coloc explorer app helpful exploring various choices mean, per-SNP per-hypothesis level. However, conducted enumeration-based coloc analysis, still helpful check inference colocalisation robust variations prior values specified. Continuing last vignette, sensitivity analysis can used, post-hoc, determine range prior probabilities conclusion still supported. sensitivity() function shows variable p12p_{12} bottom right plot, along prior probabilities hypothesis, may help decide whether particular range p12p_{12} valid. green region shows region - set values p12p_{12} - H4>0.5H_4 > 0.5 - rule specified. case, conclusion colocalisation looks quite robust. left (optionally) input data also presented, shading indicate posterior probabilities SNP causal H4H_4 true. can useful indicate serious discrepancies also.  Let’s fake smaller dataset won’t case, increasing varbeta: Now, colocalisation dependent value p12p_{12}:  case, find evidence colocalisation according rule H4>0.5H_4>0.5 p12>10−6p_{12} > 10^{-6}, corresponds priori belief P(H4)≃P(H3)P(H_4) \\simeq P(H_3). means need think reasonable H4H_4 equally likely H3H_3 begin find data convincing. Note, syntax can also consider complicated rules:","code":"library(coloc) ## This is coloc version 6.0.1 data(coloc_test_data) attach(coloc_test_data) my.res <- coloc.abf(dataset1=D1,                     dataset2=D2,                     p12=1e-6) ## PP.H0.abf PP.H1.abf PP.H2.abf PP.H3.abf PP.H4.abf  ##  1.37e-17  2.92e-09  8.53e-11  8.28e-03  9.92e-01  ## [1] \"PP abf for shared variant: 99.2%\" my.res ## Coloc analysis of trait 1, trait 2 ##  ## SNP Priors ##    p1    p2   p12  ## 1e-04 1e-04 1e-06 ##  ## Hypothesis Priors ##        H0   H1   H2       H3    H4 ##  0.897005 0.05 0.05 0.002495 5e-04 ##  ## Posterior ##        nsnps           H0           H1           H2           H3           H4  ## 5.000000e+02 1.366742e-17 2.915456e-09 8.529214e-11 8.276799e-03 9.917232e-01 sensitivity(my.res,rule=\"H4 > 0.5\") ## Results pass decision rule H4 > 0.5 my.res <- coloc.abf(dataset1=D1a,                     dataset2=D2a,                     p12=1e-6) ## PP.H0.abf PP.H1.abf PP.H2.abf PP.H3.abf PP.H4.abf  ##  5.58e-07  1.61e-05  1.26e-03  2.67e-02  9.72e-01  ## [1] \"PP abf for shared variant: 97.2%\" my.res ## Coloc analysis of trait 1, trait 2 ##  ## SNP Priors ##    p1    p2   p12  ## 1e-04 1e-04 1e-06 ##  ## Hypothesis Priors ##        H0   H1   H2       H3    H4 ##  0.897005 0.05 0.05 0.002495 5e-04 ##  ## Posterior ##        nsnps           H0           H1           H2           H3           H4  ## 5.000000e+02 5.583635e-07 1.612179e-05 1.261187e-03 2.669434e-02 9.720278e-01 sensitivity(my.res,rule=\"H4 > 0.5\") ## Results pass decision rule H4 > 0.5 sensitivity(my.res,rule=\"H4 > 3*H3 & H0 < 0.1\") ## Results pass decision rule H4 > 3*H3 & H0 < 0.1"},{"path":"https://chr1swallace.github.io/coloc/articles/a05_conditioning.html","id":"multiple-causal-variants","dir":"Articles","previous_headings":"","what":"Multiple causal variants","title":"DEPRECATED Coloc: relaxing the single causal variant assumption","text":"describes deprecated functions - SuSiE approach accurate used instead load simulated data. First, let us standard coloc (single causal variant) analysis serve baseline comparison. analysis concludes colocalisation, “sees” SNPs left strongly associated traits. misses SNPs right top left plot associated one trait.  Even though sensitivity analysis looks good, Manhattan plots suggest violating assumption single causal variant per trait. can use =finemap.signals= test whether additional signals conditioning. Note every colocalisation conditions every signal except one trait. reason, trying colocalise many signals per trait recommended. Instead, use pthr set significance (p value) required call signal. set low, capture signals non-significant, high miss true signals. pthr=5e-8 correspond genome-wide significance level common variants European study, typically choose slightly relaxed pthr=1e-6 basis one GW-significant signal region, expect greater chance secondary signals exist. Now can ask coloc consider separate signals using coloc.signals() function. Note multiple colocalisations, sensitivity() needs know consider:","code":"library(coloc) ## This is coloc version 6.0.1 data(coloc_test_data) attach(coloc_test_data) # contains D3, D4 that we will use in this vignette library(coloc) my.res <- coloc.abf(dataset1=D3, dataset2=D4) ## PP.H0.abf PP.H1.abf PP.H2.abf PP.H3.abf PP.H4.abf  ##  8.78e-26  6.80e-07  1.53e-22  1.85e-04  1.00e+00  ## [1] \"PP abf for shared variant: 100%\" class(my.res) ## [1] \"coloc_abf\" \"list\" ## print.coloc_abf my.res ## Coloc analysis of trait 1, trait 2 ##  ## SNP Priors ##    p1    p2   p12  ## 1e-04 1e-04 1e-05 ##  ## Hypothesis Priors ##        H0   H1   H2       H3    H4 ##  0.892505 0.05 0.05 0.002495 0.005 ##  ## Posterior ##        nsnps           H0           H1           H2           H3           H4  ## 5.000000e+02 8.775708e-26 6.797736e-07 1.529399e-22 1.848705e-04 9.998144e-01 sensitivity(my.res,\"H4 > 0.9\") ## Results pass decision rule H4 > 0.9 finemap.signals(D3,method=\"cond\") ##      s105       s78  ## 11.180489  5.351394 finemap.signals(D4,method=\"cond\") ##    s105  ## 6.42341 finemap.signals(D3,method=\"cond\",pthr=1e-20) ## too small ##     s105  ## 11.18049 finemap.signals(D4,method=\"cond\",pthr=0.1) ## too big ##      s105      s108      s156  ##  6.423410 -3.226812  3.741284 res <- coloc.signals(D3,D4,method=\"cond\",p12=1e-6,pthr=1e-6) ## PP.H0.abf PP.H1.abf PP.H2.abf PP.H3.abf PP.H4.abf  ##  8.76e-25  6.79e-06  1.53e-21  1.85e-03  9.98e-01  ## [1] \"PP abf for shared variant: 99.8%\" ## PP.H0.abf PP.H1.abf PP.H2.abf PP.H3.abf PP.H4.abf  ##  1.83e-05  5.53e-04  3.19e-02  9.64e-01  3.52e-03  ## [1] \"PP abf for shared variant: 0.352%\" ## PP.H0.abf PP.H1.abf PP.H2.abf PP.H3.abf PP.H4.abf  ##  5.44e-04  2.33e-05  9.49e-01  4.04e-02  1.02e-02  ## [1] \"PP abf for shared variant: 1.02%\" res ## Coloc analysis of trait 1, trait 2 ##  ## SNP Priors ##    p1    p2   p12  ## 1e-04 1e-04 1e-06 ##  ## Hypothesis Priors ##        H0   H1   H2       H3    H4 ##  0.897005 0.05 0.05 0.002495 5e-04 ##  ## Posterior ## Key: <hit2> ##    nsnps   hit1   hit2           H0           H1           H2         H3 ##    <int> <char> <char>        <num>        <num>        <num>      <num> ## 1:   500   s105   s105 8.674493e-25 6.719334e-06 1.511759e-21 0.01171021 ## 2:   500    s78   s105 1.830995e-05 5.531424e-04 3.190992e-02 0.96399665 ##             H4 ##          <num> ## 1: 0.988283067 ## 2: 0.003521974 sensitivity(res,\"H4 > 0.9\",row=1) ## Results pass decision rule H4 > 0.9 sensitivity(res,\"H4 > 0.9\",row=2) ## Results fail decision rule H4 > 0.9"},{"path":"https://chr1swallace.github.io/coloc/articles/a06_SuSiE.html","id":"multiple-causal-variants-using-susie-to-separate-the-signals","dir":"Articles","previous_headings":"","what":"Multiple causal variants, using SuSiE to separate the signals","title":"Coloc: using SuSiE to relax the single causal variant assumption","text":"load simulated data. Datasets 3 4 constructed deliberately break single causal variant assumption coloc.abf().  First, let us standard coloc (single causal variant) analysis serve baseline comparison. analysis concludes colocalisation, “sees” SNPs left strongly associated traits. misses SNPs right top left plot associated one trait.  Even though sensitivity analysis looks good, Manhattan plots suggest violating assumption single causal variant per trait. coloc adopted SuSiE framework fine mapping presence multiple causal variants. framework requires LD matrix known, first check datasets hold LD matrix right format. =check_dataset= return NULL problems, print informative error messages . SuSiE can take run larger datasets, best run per dataset =runsusie= function, store results feed subsequent analyses. =runsusie= just wrapper around =susie_rss= function susieR package automates running convergence saves little extra information snp names make subsequent coloc processing simpler. , indeed find two signals dataset D3 (two rows credible sets summary) one dataset D4. susie output objects stored, can colocalise every pair signals. analysis says first pair, tagged s25.1 s25 datasets D3 D4, colocalise (posterior H3 close 1), whilst second pair, tagged SNP, s25, datasets, (posterior H4 close 1). Note multiple colocalisations, sensitivity() needs know consider, need give datasets used want see Manhattan plots.","code":"library(coloc) ## This is coloc version 6.0.1 data(coloc_test_data) attach(coloc_test_data) ## datasets D1, D2, D3 and D4 par(mfrow=c(2,1)) plot_dataset(D3, main=\"Dataset D3\") plot_dataset(D4, main=\"Dataset D4\") my.res <- coloc.abf(dataset1=D3, dataset2=D4) ## PP.H0.abf PP.H1.abf PP.H2.abf PP.H3.abf PP.H4.abf  ##  8.78e-26  6.80e-07  1.53e-22  1.85e-04  1.00e+00  ## [1] \"PP abf for shared variant: 100%\" class(my.res) ## [1] \"coloc_abf\" \"list\" ## print.coloc_abf my.res ## Coloc analysis of trait 1, trait 2 ##  ## SNP Priors ##    p1    p2   p12  ## 1e-04 1e-04 1e-05 ##  ## Hypothesis Priors ##        H0   H1   H2       H3    H4 ##  0.892505 0.05 0.05 0.002495 0.005 ##  ## Posterior ##        nsnps           H0           H1           H2           H3           H4  ## 5.000000e+02 8.775708e-26 6.797736e-07 1.529399e-22 1.848705e-04 9.998144e-01 sensitivity(my.res,\"H4 > 0.9\") ## Results pass decision rule H4 > 0.9 check_dataset(D3,req=\"LD\") ## NULL check_dataset(D4,req=\"LD\") ## NULL S3=runsusie(D3) ## running max iterations: 100 ##  converged: TRUE summary(S3) ##  ## Variables in credible sets: ##  ##  variable variable_prob cs ##       105   0.777112364  1 ##        89   0.395106280  2 ##        87   0.271833777  2 ##        82   0.106275736  1 ##       103   0.080325924  1 ##        81   0.057211679  2 ##        80   0.051878567  2 ##        84   0.037874443  2 ##        68   0.036058478  2 ##        97   0.030410224  2 ##        75   0.018683900  2 ##       113   0.014731357  2 ##        69   0.011078296  2 ##        58   0.010512961  2 ##        73   0.008534130  2 ##       108   0.007895691  2 ##  ## Credible sets summary: ##  ##  cs cs_log10bf cs_avg_r2 cs_min_r2                                 variable ##   1   8.626019 0.6743405 0.5947188                               82,103,105 ##   2   3.492207 0.6237635 0.4582396 58,68,69,73,75,80,81,84,87,89,97,108,113 S4=runsusie(D4) ## running max iterations: 100 ##  converged: TRUE summary(S4) ##  ## Variables in credible sets: ##  ##  variable variable_prob cs ##       105     0.9051715  1 ##       156     0.0605820  1 ##  ## Credible sets summary: ##  ##  cs cs_log10bf cs_avg_r2 cs_min_r2 variable ##   1   4.940381 0.5047112 0.5047112  105,156 if(requireNamespace(\"susieR\",quietly=TRUE)) {   susie.res=coloc.susie(S3,S4)   print(susie.res$summary) } ##    nsnps   hit1   hit2    PP.H0.abf    PP.H1.abf    PP.H2.abf    PP.H3.abf ##    <int> <char> <char>        <num>        <num>        <num>        <num> ## 1:   500   s105   s105 3.079008e-14 6.507291e-07 1.342030e-10 0.0008379729 ## 2:   500    s89   s105 1.422896e-06 2.209787e-04 6.201896e-03 0.9631063078 ##     PP.H4.abf  idx1  idx2 ##         <num> <int> <int> ## 1: 0.99916138     1     1 ## 2: 0.03046939     2     1 if(requireNamespace(\"susieR\",quietly=TRUE)) {   sensitivity(susie.res,\"H4 > 0.9\",row=1,dataset1=D3,dataset2=D4)   sensitivity(susie.res,\"H4 > 0.9\",row=2,dataset1=D3,dataset2=D4) } ## Results pass decision rule H4 > 0.9 ## Results fail decision rule H4 > 0.9"},{"path":"https://chr1swallace.github.io/coloc/articles/a06_SuSiE.html","id":"important-notes-on-running-susie","dir":"Articles","previous_headings":"","what":"Important notes on running SuSiE","title":"Coloc: using SuSiE to relax the single causal variant assumption","text":"runsusie() wrapper around susieR::susie_rss(). adds colnames returned objects (snps can identified easily) repeats calls susie_rss() convergence achieved. susie_rss() many options look runsusie() giving output expect. can passed directly runsusie(). One option varied help SuSiE detect weaker signals, coverage parameter. default susie_rss looks signals can form 95% credible set. reducing coverage, can find weaker signals. example find nothing weaker signal dataset reducing coverage can find one signal values just illustration, probably wouldn’t believe signal real dataset p>10−5p > 10^{-5}. let find weaker signals, signals find may real! coloc results treated caution. Nonetheless, may worthwhile dataset weak signal know replicated independent data.","code":"if(requireNamespace(\"susieR\",quietly=TRUE)) {   ?susieR::susie_rss } if(requireNamespace(\"susieR\",quietly=TRUE)) {   ## make a dataset with a weaker signal   D5=D3   D5$varbeta=D5$varbeta * 4   D5$N=D5$N / 2   par(mfrow=c(1,2))   plot_dataset(D3, main=\"original D3\")   plot_dataset(D5, main=\"weaker signal D5\")   summary(runsusie(D5)) # default coverage 0.95 } if(requireNamespace(\"susieR\",quietly=TRUE)) {   summary(runsusie(D5,coverage=0.1))  # lower coverage } if(requireNamespace(\"susieR\",quietly=TRUE)) {   S5=runsusie(D5,coverage=0.1)  # lower coverage   summary(S5)   res=coloc.susie(S5,S4)   print(res$summary) }"},{"path":"https://chr1swallace.github.io/coloc/articles/a07_variant-specific-priors.html","id":"variant-specific-priors-in-coloc","dir":"Articles","previous_headings":"","what":"Variant-specific priors in coloc","title":"Coloc: using variant-specific priros in coloc","text":"default coloc assumes variants region equally likely causal traits interest. However, substantial evidence functional annotations genetic information can provide evidence whether variants causal.","code":"library(coloc) ## This is coloc version 6.0.1 data(coloc_test_data) data(eqtlgen_density_data) attach(coloc_test_data) attach(eqtlgen_density_data)"},{"path":"https://chr1swallace.github.io/coloc/articles/a07_variant-specific-priors.html","id":"using-general-variant-specific-information","dir":"Articles","previous_headings":"","what":"Using general variant-specific information","title":"Coloc: using variant-specific priros in coloc","text":"provide variant-specific information coloc use prior_weights1 prior_weights2 arguments coloc.abf(), coloc.susie() coloc.bf(). arguments specify non-negative weights encode ‘weight’ (proportional probability variant causal). Specifying weights either traits automatically change prior probability variant causal traits. example, prior information first 100 variants twice likely causal trait 1 encode following prior weights:","code":"weights <- c(rep(2, 100), rep(1, 400)) coloc.abf(D1, D2, prior_weights1 = weights) ## PP.H0.abf PP.H1.abf PP.H2.abf PP.H3.abf PP.H4.abf  ##  8.26e-19  2.91e-10  5.16e-12  8.18e-04  9.99e-01  ## [1] \"PP abf for shared variant: 99.9%\" ## Coloc analysis of trait 1, trait 2 ##  ## SNP Priors ##    p1    p2   p12  ## 1e-04 1e-04 1e-05 ##  ## Hypothesis Priors ##        H0   H1   H2       H3    H4 ##  0.892505 0.05 0.05 0.002495 0.005 ##  ## Posterior ##        nsnps           H0           H1           H2           H3           H4  ## 5.000000e+02 8.262373e-19 2.911768e-10 5.156170e-12 8.179198e-04 9.991821e-01"},{"path":"https://chr1swallace.github.io/coloc/articles/a07_variant-specific-priors.html","id":"an-example-of-variant-specific-information","dir":"Articles","previous_headings":"","what":"An example of variant-specific information","title":"Coloc: using variant-specific priros in coloc","text":"Pullin Wallace (2024) describe implementation variant-specific priors coloc compare various sources prior information. best performing source prior information density distance expression quantative trait loci (eQTL) gene’s transcription start site (TSS). estimated densities show eQTLs often lie close TSS, suggesting expect variants lie closer TSS likely causal. density estimated eQTLGen dataset, see Pullin Wallace (2024) details, stored coloc dataset eqtlgen_density_data can visualise density, middle interval TSS.  illustrate use TSS augment coloc’s simulated data simulated genomic positions 1Mb window around TSS PTPN22. using simple function can compute prior weights positions relative different specified TSSs. Computing weights applying shows little impact probability colocalisation simulated example strong evidence colocalisation. real data, impact likely greater.","code":"plot(   eqtlgen_density_data$rel_dist,   eqtlgen_density_data$dens_value ) pos <- sample(113371759:114371759, 500, replace = FALSE) D1$position <- pos D2$position <- pos  compute_eqtl_tss_dist_weights <- function(pos, tss, density_data) {   rel <- pos - tss   closest <- numeric(length(pos))   for (i in seq_along(pos)) {     closest[[i]] <- which.min(abs(density_data$rel_dist - rel[[i]]))   }   out <- density_data$dens_value[closest]   out <- out / sum(out)   out } # Compute the weights relative to the PTPN22 TSS. w1 <- compute_eqtl_tss_dist_weights(D1$position, 113871759, eqtlgen_density_data)   coloc.abf(D1, D2) ## PP.H0.abf PP.H1.abf PP.H2.abf PP.H3.abf PP.H4.abf  ##  1.38e-18  2.94e-10  8.59e-12  8.34e-04  9.99e-01  ## [1] \"PP abf for shared variant: 99.9%\" ## Coloc analysis of trait 1, trait 2 ##  ## SNP Priors ##    p1    p2   p12  ## 1e-04 1e-04 1e-05 ##  ## Hypothesis Priors ##        H0   H1   H2       H3    H4 ##  0.892505 0.05 0.05 0.002495 0.005 ##  ## Posterior ##        nsnps           H0           H1           H2           H3           H4  ## 5.000000e+02 1.377000e-18 2.937336e-10 8.593226e-12 8.338917e-04 9.991661e-01 coloc.abf(D1, D2, prior_weights1 = w1) ## PP.H0.abf PP.H1.abf PP.H2.abf PP.H3.abf PP.H4.abf  ##  4.61e-17  1.19e-09  2.88e-10  6.44e-03  9.94e-01  ## [1] \"PP abf for shared variant: 99.4%\" ## Coloc analysis of trait 1, trait 2 ##  ## SNP Priors ##    p1    p2   p12  ## 1e-04 1e-04 1e-05 ##  ## Hypothesis Priors ##        H0   H1   H2       H3    H4 ##  0.892505 0.05 0.05 0.002495 0.005 ##  ## Posterior ##        nsnps           H0           H1           H2           H3           H4  ## 5.000000e+02 4.607613e-17 1.191318e-09 2.875401e-10 6.440915e-03 9.935591e-01"},{"path":"https://chr1swallace.github.io/coloc/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Chris Wallace. Author, maintainer. Claudia Giambartolomei. Author. Vincent Plagnol. Contributor. Tom Willis. Author. Jeffrey Pullin. Author.","code":""},{"path":"https://chr1swallace.github.io/coloc/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Giambartolomei C, al e (2014). “Bayesian Test Colocalisation Pairs Genetic Association Studies Using Summary Statistics.” PLOS Genetics. https://doi.org/10.1371/journal.pgen.1004383. Wallace C (2020). “Eliciting priors relaxing single causal variant assumption colocalisation analyses.” PLOS Genetics. https://doi.org/10.1371/journal.pgen.1008720. Wallace C (2021). “accurate method colocalisation analysis allowing multiple causal variants.” PLOS Genetics. https://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1009440.","code":"@Article{,   author = {C Giambartolomei and et. al},   title = {Bayesian Test for Colocalisation between Pairs of Genetic Association Studies Using Summary Statistics},   journal = {PLOS Genetics},   year = {2014},   url = {https://doi.org/10.1371/journal.pgen.1004383}, } @Article{,   author = {C Wallace},   title = {{Eliciting priors and relaxing the single causal variant assumption in colocalisation analyses}},   journal = {PLOS Genetics},   year = {2020},   url = {https://doi.org/10.1371/journal.pgen.1008720}, } @Article{,   author = {C Wallace},   title = {{A more accurate method for colocalisation analysis allowing for multiple causal variants}},   journal = {{PLOS Genetics}},   year = {2021},   url = {https://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1009440}, }"},{"path":"https://chr1swallace.github.io/coloc/index.html","id":"coloc","dir":"","previous_headings":"","what":"Colocalisation Tests of Two Genetic Traits","title":"Colocalisation Tests of Two Genetic Traits","text":"coloc package can used perform genetic colocalisation analysis two potentially related phenotypes, ask whether share common genetic causal variant(s) given region. questions get relate misunderstanding assumptions behind coloc (dense genotypes across single genomic region) /data structures used. Please read vignette(\"a02_data\",package=\"coloc\") starting issue. FAQ page may also helpful.","code":""},{"path":"https://chr1swallace.github.io/coloc/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Colocalisation Tests of Two Genetic Traits","text":"install latest stable CRAN version coloc run: install development version coloc GitHub run:","code":"install.packages(\"coloc\") if(!require(\"remotes\"))    install.packages(\"remotes\") # if necessary remotes::install_github(\"chr1swallace/coloc@main\",build_vignettes=TRUE)"},{"path":"https://chr1swallace.github.io/coloc/index.html","id":"version-6","dir":"","previous_headings":"","what":"Version 6","title":"Colocalisation Tests of Two Genetic Traits","text":"update (version 6) adds ability use variant-specific priors coloc. See Pullin JM, Wallace C (2025) Variant-specific priors clarify colocalisation analysis. PLoS Genet 21(5): e1011697. https://doi.org/10.1371/journal.pgen.1011697 description implementation comparison different sources prior information. use variant-specific priors coloc please cite paper. detail also available vignette a07_variant_specific_priors.html accessible ","code":"vignette(\"a07-variant_specific_priors\",package=\"coloc\")"},{"path":"https://chr1swallace.github.io/coloc/index.html","id":"version-5","dir":"","previous_headings":"","what":"Version 5","title":"Colocalisation Tests of Two Genetic Traits","text":"Version 5 superseded previously published version 4 introducing use SuSiE approach deal multiple causal variants rather conditioning masking. See Wang, G., Sarkar, ., Carbonetto, P., & Stephens, M. (2020). simple new approach variable selection regression, application genetic fine mapping. Journal Royal Statistical Society: Series B (Statistical Methodology). https://doi.org/10.1111/rssb.12388 full SuSiE paper Wallace (2021). accurate method colocalisation analysis allowing multiple causal variants. PLoS Genetics. https://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1009440 description use coloc. Note simulations, susie outperforms earlier conditioning approach, recommended. use susie coloc please look coloc.susie. can take raw datasets, time consuming part running SuSiE. coloc runs SuSiE saves little extra information using runsusie function running adapted colocalisation results. please look docs runsusie . helpful recipe Run runsusie dataset 1, storing results Run runsusie dataset 2, storing results Run coloc.susie two outputs detail available vignette a06_SuSiE.html accessible ","code":"vignette(\"a06_SuSiE\",package=\"coloc\")"},{"path":"https://chr1swallace.github.io/coloc/index.html","id":"frequently-asked-questions","dir":"","previous_headings":"","what":"Frequently Asked Questions","title":"Colocalisation Tests of Two Genetic Traits","text":"Please see FAQ page issues questions.","code":""},{"path":"https://chr1swallace.github.io/coloc/index.html","id":"background-reading","dir":"","previous_headings":"","what":"Background reading","title":"Colocalisation Tests of Two Genetic Traits","text":"usage, please see vignette https://chr1swallace.github.io/coloc Key previous references : Original propostion proportional colocalisation Plagnol et al (2009) Proportional colocalisation type 1 error rate control Wallace et al (2013) Colocalisation enumerating possible causal SNP configurations two traits, assuming one causal variant per trait Giambartolomei et al (2013) Thoughts priors coloc described Wallace C (2020)","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/Var.data.cc.html","id":null,"dir":"Reference","previous_headings":"","what":"Var.data — Var.data.cc","title":"Var.data — Var.data.cc","text":"variance MLE beta case-control","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/Var.data.cc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Var.data — Var.data.cc","text":"","code":"Var.data.cc(f, N, s)"},{"path":"https://chr1swallace.github.io/coloc/reference/Var.data.cc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Var.data — Var.data.cc","text":"f minor allele freq N sample number s ???","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/Var.data.cc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Var.data — Var.data.cc","text":"variance MLE beta","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/Var.data.cc.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Var.data — Var.data.cc","text":"Internal function","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/Var.data.cc.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Var.data — Var.data.cc","text":"Claudia Giambartolomei","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/Var.data.html","id":null,"dir":"Reference","previous_headings":"","what":"Var.data — Var.data","title":"Var.data — Var.data","text":"variance MLE beta quantitative trait, assuming var(y)=1","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/Var.data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Var.data — Var.data","text":"","code":"Var.data(f, N)"},{"path":"https://chr1swallace.github.io/coloc/reference/Var.data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Var.data — Var.data","text":"f minor allele freq N sample number","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/Var.data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Var.data — Var.data","text":"variance MLE beta","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/Var.data.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Var.data — Var.data","text":"Internal function","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/Var.data.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Var.data — Var.data","text":"Claudia Giambartolomei","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/annotate_susie.html","id":null,"dir":"Reference","previous_headings":"","what":"annotate susie_rss output for use with coloc_susie — annotate_susie","title":"annotate susie_rss output for use with coloc_susie — annotate_susie","text":"coloc functions need able link summary stats two different datasets snp identifiers.  function takes output susie_rss() adds snp identifiers. entirely user's responsibility ensure snp identifiers correct order, coloc make sanity checks.","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/annotate_susie.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"annotate susie_rss output for use with coloc_susie — annotate_susie","text":"","code":"annotate_susie(res, snp, LD)"},{"path":"https://chr1swallace.github.io/coloc/reference/annotate_susie.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"annotate susie_rss output for use with coloc_susie — annotate_susie","text":"res output susie_rss() snp vector snp identifiers LD matrix LD (r) snps snp identifiers. Columns, rows named string exists vector snp","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/annotate_susie.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"annotate susie_rss output for use with coloc_susie — annotate_susie","text":"res column names added components","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/annotate_susie.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"annotate susie_rss output for use with coloc_susie — annotate_susie","text":"Note: annotation step needed use runsusie() - required use susieR functions directly","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/annotate_susie.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"annotate susie_rss output for use with coloc_susie — annotate_susie","text":"Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/approx.bf.estimates.html","id":null,"dir":"Reference","previous_headings":"","what":"Internal function, approx.bf.estimates — approx.bf.estimates","title":"Internal function, approx.bf.estimates — approx.bf.estimates","text":"Internal function, approx.bf.estimates","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/approx.bf.estimates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Internal function, approx.bf.estimates — approx.bf.estimates","text":"","code":"approx.bf.estimates(   z,   V,   type,   suffix = NULL,   sdY = 1,   effect_priors = c(quant = 0.15, cc = 0.2) )"},{"path":"https://chr1swallace.github.io/coloc/reference/approx.bf.estimates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Internal function, approx.bf.estimates — approx.bf.estimates","text":"z normal deviate associated regression coefficient variance V variance type \"quant\" \"cc\" suffix suffix append column names returned data.frame sdY standard deviation trait. supplied, estimated. effect_priors named vector variance prior effect sizes quantitative case-control traits. change unless know !","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/approx.bf.estimates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Internal function, approx.bf.estimates — approx.bf.estimates","text":"data.frame containing lABF intermediate calculations","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/approx.bf.estimates.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Internal function, approx.bf.estimates — approx.bf.estimates","text":"Calculate approximate Bayes Factors using supplied variance regression coefficients","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/approx.bf.estimates.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Internal function, approx.bf.estimates — approx.bf.estimates","text":"Vincent Plagnol, Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/approx.bf.p.html","id":null,"dir":"Reference","previous_headings":"","what":"Internal function, approx.bf.p — approx.bf.p","title":"Internal function, approx.bf.p — approx.bf.p","text":"Internal function, approx.bf.p","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/approx.bf.p.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Internal function, approx.bf.p — approx.bf.p","text":"","code":"approx.bf.p(p, f, type, N, s, suffix = NULL)"},{"path":"https://chr1swallace.github.io/coloc/reference/approx.bf.p.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Internal function, approx.bf.p — approx.bf.p","text":"p p value f MAF type \"quant\" \"cc\" N sample size s proportion samples cases, ignored type==\"quant\" suffix suffix append column names returned data.frame","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/approx.bf.p.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Internal function, approx.bf.p — approx.bf.p","text":"data.frame containing lABF intermediate calculations","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/approx.bf.p.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Internal function, approx.bf.p — approx.bf.p","text":"Calculate approximate Bayes Factors","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/approx.bf.p.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Internal function, approx.bf.p — approx.bf.p","text":"Claudia Giambartolomei, Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/bin2lin.html","id":null,"dir":"Reference","previous_headings":"","what":"binomial to linear regression conversion — bin2lin","title":"binomial to linear regression conversion — bin2lin","text":"Convert binomial linear regression","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/bin2lin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"binomial to linear regression conversion — bin2lin","text":"","code":"bin2lin(D, doplot = FALSE)"},{"path":"https://chr1swallace.github.io/coloc/reference/bin2lin.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"binomial to linear regression conversion — bin2lin","text":"D standard format coloc dataset doplot plot results TRUE - useful debugging","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/bin2lin.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"binomial to linear regression conversion — bin2lin","text":"D, original beta varbeta beta.bin, varbeta.bin, beta varbeta updated linear estimates","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/bin2lin.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"binomial to linear regression conversion — bin2lin","text":"Estimate beta varbeta linear regression run binary outcome, given log variance + MAF controls sets beta = cov(x,y)/var(x) varbeta = (var(y)/var(x) - cov(x,y)^2/var(x)^2)/N","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/bin2lin.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"binomial to linear regression conversion — bin2lin","text":"Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/check_alignment.html","id":null,"dir":"Reference","previous_headings":"","what":"check alignment — check_alignment","title":"check alignment — check_alignment","text":"check alignment beta LD","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/check_alignment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"check alignment — check_alignment","text":"","code":"check_alignment(D, thr = 0.2, do_plot = TRUE)  check.alignment(...)"},{"path":"https://chr1swallace.github.io/coloc/reference/check_alignment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"check alignment — check_alignment","text":"D coloc dataset thr plot SNP pairs absolute LD > thr do_plot TRUE (default) plot diagnostic ... arguments passed check_alignment()","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/check_alignment.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"check alignment — check_alignment","text":"proportion pairs positive","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/check_alignment.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"check alignment — check_alignment","text":"Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/check_dataset.html","id":null,"dir":"Reference","previous_headings":"","what":"check_dataset — check_dataset","title":"check_dataset — check_dataset","text":"Check coloc dataset inputs errors","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/check_dataset.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"check_dataset — check_dataset","text":"","code":"check_dataset(d, suffix = \"\", req = c(\"type\", \"snp\"), warn.minp = 1e-06)  check.dataset(...)"},{"path":"https://chr1swallace.github.io/coloc/reference/check_dataset.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"check_dataset — check_dataset","text":"d dataset check suffix string identify dataset (1 2) req names elements must present warn.minp print warning p value < warn.minp ... arguments passed check_dataset()","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/check_dataset.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"check_dataset — check_dataset","text":"NULL errors found","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/check_dataset.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"check_dataset — check_dataset","text":"coloc dataset list, containing mixture vectors capturing quantities vary snps (vectors must equal length) scalars capturing quantities describe dataset. Coloc flexible, requiring perhaps p values, z scores, effect estimates standard errors, flexibility, also comes difficulties describing exactly combinations items required. Required vectors subset beta regression coefficient SNP dataset 1 varbeta variance beta pvalues P-values SNP dataset 1 MAF minor allele frequency variants snp character vector snp ids, optional. used merge dataset1 dataset2 retained results. Preferably, give beta varbeta.  available, sufficient statistics can approximated pvalues MAF. Required scalars subset N Number samples dataset 1 type type data dataset 1 - either \"quant\" \"cc\" denote quantitative case-control s case control dataset, proportion samples dataset 1 cases sdY quantitative trait, population standard deviation trait.  given, can estimated vectors varbeta MAF must always give type.  , type==\"cc\" s type==\"quant\" sdY known sdY beta, varbeta known N sdY unknown, approximated, require summary data estimate sdY beta, varbeta, N, MAF Optional vectors position vector snp positions, required plot_dataset check_dataset calls stop() unless series expectations dataset input format met helper function use coloc functions, can use directly check format dataset supplied coloc.abf(), coloc.signals(), finemap.abf(), finemap.signals().","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/check_dataset.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"check_dataset — check_dataset","text":"Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc-package.html","id":null,"dir":"Reference","previous_headings":"","what":"Colocalisation tests of two genetic traits — coloc-package","title":"Colocalisation tests of two genetic traits — coloc-package","text":"Performs colocalisation tests described Plagnol et al (2009) Wallace et al (2020) draws plots.","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Colocalisation tests of two genetic traits — coloc-package","text":"Chris Wallace cew54@cam.ac.uk","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.abf.html","id":null,"dir":"Reference","previous_headings":"","what":"Fully Bayesian colocalisation analysis using Bayes Factors — coloc.abf","title":"Fully Bayesian colocalisation analysis using Bayes Factors — coloc.abf","text":"Bayesian colocalisation analysis","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.abf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fully Bayesian colocalisation analysis using Bayes Factors — coloc.abf","text":"","code":"coloc.abf(   dataset1,   dataset2,   MAF = NULL,   p1 = 1e-04,   p2 = 1e-04,   p12 = 1e-05,   prior_weights1 = NULL,   prior_weights2 = NULL,   ... )"},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.abf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fully Bayesian colocalisation analysis using Bayes Factors — coloc.abf","text":"dataset1 list specifically named elements defining dataset analysed. See check_dataset details. dataset2 , dataset 2 MAF Common minor allele frequency vector used dataset1 dataset2, shorthand supplying vector parts datasets p1 prior probability SNP associated trait 1, default 1e-4 p2 prior probability SNP associated trait 2, default 1e-4 p12 prior probability SNP associated traits, default 1e-5 prior_weights1 Non-negative weights prior probability SNP associated trait 1 prior_weights2 Non-negative weights prior probability SNP asscoiated trait 2 ... used pass parameters approx.bf.estimates, particular effect_priors parameter","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.abf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fully Bayesian colocalisation analysis using Bayes Factors — coloc.abf","text":"list two data.frames: summary vector giving number SNPs analysed, posterior probabilities H0 (causal variant), H1 (causal variant trait 1 ), H2 (causal variant trait 2 ), H3 (two distinct causal variants) H4 (one common causal variant) results annotated version input data containing log Approximate Bayes Factors intermediate calculations, posterior probability SNP.PP.H4 SNP causal shared signal H4 true. relevant posterior support H4 summary convincing.","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.abf.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fully Bayesian colocalisation analysis using Bayes Factors — coloc.abf","text":"function calculates posterior probabilities different causal variant configurations assumption single causal variant trait. regression coefficients variances available, calculates Bayes factors association SNP.  p values available, uses approximation depends SNP's MAF ignores uncertainty imputation.  Regression coefficients used available.","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.abf.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Fully Bayesian colocalisation analysis using Bayes Factors — coloc.abf","text":"Claudia Giambartolomei, Chris Wallace, Jeffrey Pullin","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.bf_bf.html","id":null,"dir":"Reference","previous_headings":"","what":"Coloc data through Bayes factors — coloc.bf_bf","title":"Coloc data through Bayes factors — coloc.bf_bf","text":"Colocalise two datasets represented Bayes factors","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.bf_bf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Coloc data through Bayes factors — coloc.bf_bf","text":"","code":"coloc.bf_bf(   bf1,   bf2,   p1 = 1e-04,   p2 = 1e-04,   p12 = 5e-06,   overlap.min = 0.5,   trim_by_posterior = TRUE,   prior_weights1 = NULL,   prior_weights2 = NULL )"},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.bf_bf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Coloc data through Bayes factors — coloc.bf_bf","text":"bf1 named vector log BF, matrix BF colnames (cols=snps, rows=signals) bf2 named vector log BF, matrix BF colnames (cols=snps, rows=signals) p1 prior probability SNP associated trait 1, default 1e-4 p2 prior probability SNP associated trait 2, default 1e-4 p12 prior probability SNP associated traits, default 1e-5 overlap.min see trim_by_posterior trim_by_posterior important signals colocalised covered adequate numbers snps datasets. TRUE, signals snps common capture least overlap.min proportion posteriors support dropped colocalisation attempted. prior_weights1 Non-negative weights prior probability SNP associated trait 1 prior_weights2 Non-negative weights prior probability SNP asscoiated trait 2","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.bf_bf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Coloc data through Bayes factors — coloc.bf_bf","text":"coloc.signals style result","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.bf_bf.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Coloc data through Bayes factors — coloc.bf_bf","text":"workhorse behind many coloc functions","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.bf_bf.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Coloc data through Bayes factors — coloc.bf_bf","text":"Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.detail.html","id":null,"dir":"Reference","previous_headings":"","what":"Bayesian colocalisation analysis with detailed output — coloc.detail","title":"Bayesian colocalisation analysis with detailed output — coloc.detail","text":"Bayesian colocalisation analysis, detailed output","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.detail.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bayesian colocalisation analysis with detailed output — coloc.detail","text":"","code":"coloc.detail(   dataset1,   dataset2,   MAF = NULL,   p1 = 1e-04,   p2 = 1e-04,   p12 = 1e-05 )"},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.detail.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bayesian colocalisation analysis with detailed output — coloc.detail","text":"dataset1 list specifically named elements defining dataset analysed. See check_dataset details. dataset2 , dataset 2 MAF Common minor allele frequency vector used dataset1 dataset2, shorthand supplying vector parts datasets p1 prior probability SNP associated trait 1, default 1e-4 p2 prior probability SNP associated trait 2, default 1e-4 p12 prior probability SNP associated traits, default 1e-5","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.detail.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bayesian colocalisation analysis with detailed output — coloc.detail","text":"list three data.tabless: summary vector giving number SNPs analysed, posterior probabilities H0 (causal variant), H1 (causal variant trait 1 ), H2 (causal variant trait 2 ), H3 (two distinct causal variants) H4 (one common causal variant) df annotated version input data containing log Approximate Bayes Factors intermediate calculations, posterior probability SNP.PP.H4 SNP causal shared signal df3 2 SNP H3 models","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.detail.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Bayesian colocalisation analysis with detailed output — coloc.detail","text":"function replicates coloc.abf, outputs detail processing using coloc.process Intended called internally coloc.signals","code":""},{"path":[]},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.detail.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Bayesian colocalisation analysis with detailed output — coloc.detail","text":"Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.process.html","id":null,"dir":"Reference","previous_headings":"","what":"Post process a coloc.details result using masking — coloc.process","title":"Post process a coloc.details result using masking — coloc.process","text":"Internal helper function","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.process.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Post process a coloc.details result using masking — coloc.process","text":"","code":"coloc.process(   obj,   hits1 = NULL,   hits2 = NULL,   LD = NULL,   r2thr = 0.01,   p1 = 1e-04,   p2 = 1e-04,   p12 = 1e-06,   LD1 = LD,   LD2 = LD,   mode = c(\"iterative\", \"allbutone\") )"},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.process.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Post process a coloc.details result using masking — coloc.process","text":"obj object returned coloc.detail() hits1 lead snps trait 1. length > 1, use masking hits2 lead snps trait 2. length > 1, use masking LD named LD matrix (masking) r2thr r2 threshold mask p1 prior probability SNP associated trait 1, default 1e-4 p2 prior probability SNP associated trait 2, default 1e-4 p12 prior probability SNP associated traits, default 1e-5 LD1 named LD matrix (masking) trait 1 LD2 named LD matrix (masking) trait 2 mode either \"iterative\" (default) - successively condition signals \"allbutone\" - find putative signals condition one analysis","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.process.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Post process a coloc.details result using masking — coloc.process","text":"data.table coloc results","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.process.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Post process a coloc.details result using masking — coloc.process","text":"Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.signals.html","id":null,"dir":"Reference","previous_headings":"","what":"Coloc with multiple signals per trait — coloc.signals","title":"Coloc with multiple signals per trait — coloc.signals","text":"New coloc function, builds coloc.abf() allowing multiple independent causal variants per trait conditioning masking.","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.signals.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Coloc with multiple signals per trait — coloc.signals","text":"","code":"coloc.signals(   dataset1,   dataset2,   MAF = NULL,   LD = NULL,   method = c(\"single\", \"cond\", \"mask\"),   mode = c(\"iterative\", \"allbutone\"),   p1 = 1e-04,   p2 = 1e-04,   p12 = NULL,   maxhits = 3,   r2thr = 0.01,   pthr = 1e-06 )"},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.signals.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Coloc with multiple signals per trait — coloc.signals","text":"dataset1 list specifically named elements defining dataset analysed. See check_dataset details. dataset2 , dataset 2 MAF Common minor allele frequency vector used dataset1 dataset2, shorthand supplying vector parts datasets LD required method=\"cond\". matrix genotype correlation (ie r, r^2) SNPs. dataset1 dataset2 may different LD, can instead add LD=LD1 list dataset1 different LD matrix dataset2 method default \"\" means conditioning, return similar coloc.abf.  method=\"cond\", use conditioning coloc multiple signals.  method=\"mask\", use masking coloc multiple signals. different datasets need different methods (eg LD available one ) can set method per-dataset basis adding method=\"...\" list dataset. mode \"iterative\" \"allbutone\".  Easiest understood example.  Suppose 3 signal SNPs detected trait 1, , B, C one trait 2, D.   p1 prior probability SNP associated trait 1, default 1e-4 p2 prior probability SNP associated trait 2, default 1e-4 p12 prior probability SNP associated traits, default 1e-5 maxhits maximum number levels condition/mask r2thr masking, threshold r2 used call two signals independent.  experience needs set low avoid double calling strong signal. pthr masking conditioning, p value threshold call secondary hit \"significant\"","code":"Under \"iterative\" mode, 3 coloc will be performed: * trait 1 - trait 2 * trait 1 conditioned on A - trait 2 * trait 1 conditioned on A+B - trait 2  Under \"allbutone\" mode, they would be * trait 1 conditioned on B+C - trait 2 * trait 1 conditioned on A+C - trait 2 * trait 1 conditioned on A+B - trait 2  Only iterative mode is supported for method=\"mask\".  The allbutone mode is optimal if the signals are known with certainty (which they never are), because it allows each signal to be tested without influence of the others.  When there is uncertainty, it may make sense to use iterative mode, because the strongest signals aren't affected by conditioning incorrectly on weaker secondary and less certain signals."},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.signals.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Coloc with multiple signals per trait — coloc.signals","text":"data.table coloc results, one row per pair lead snps detected dataset","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.signals.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Coloc with multiple signals per trait — coloc.signals","text":"Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.susie.html","id":null,"dir":"Reference","previous_headings":"","what":"run coloc using susie to detect separate signals — coloc.susie","title":"run coloc using susie to detect separate signals — coloc.susie","text":"colocalisation multiple causal variants via SuSiE","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.susie.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"run coloc using susie to detect separate signals — coloc.susie","text":"","code":"coloc.susie(   dataset1,   dataset2,   back_calculate_lbf = FALSE,   susie.args = list(),   ... )"},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.susie.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"run coloc using susie to detect separate signals — coloc.susie","text":"dataset1 either coloc-style input dataset (see check_dataset), result running runsusie dataset dataset2 either coloc-style input dataset (see check_dataset), result running runsusie dataset back_calculate_lbf default, use log Bayes factors returned susie_rss. also possible back-calculate posterior probabilities. advised set TRUE, option exists really testing purposes . susie.args named list additional arguments passed runsusie ... arguments passed coloc.bf_bf, particular prior values causal association one trait (p1, p2) (p12) prior weights.","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.susie.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"run coloc using susie to detect separate signals — coloc.susie","text":"list, containing elements * summary data.table posterior probabilities global hypothesis, one row per pairwise comparison signals two traits * results data.table detailed results giving posterior probability snp jointly causal traits assuming H4 true. Please ignore column corresponding posterior support H4 high. * priors vector priors used analysis","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.susie.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"run coloc using susie to detect separate signals — coloc.susie","text":"Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.susie_bf.html","id":null,"dir":"Reference","previous_headings":"","what":"run coloc using susie to detect separate signals — coloc.susie_bf","title":"run coloc using susie to detect separate signals — coloc.susie_bf","text":"coloc susie output + separate BF matrix","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.susie_bf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"run coloc using susie to detect separate signals — coloc.susie_bf","text":"","code":"coloc.susie_bf(   dataset1,   bf2,   p1 = 1e-04,   p2 = 1e-04,   p12 = 5e-06,   susie.args = list(),   ... )"},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.susie_bf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"run coloc using susie to detect separate signals — coloc.susie_bf","text":"dataset1 list specifically named elements defining dataset analysed. See check_dataset details. bf2 named vector log BF, names snp ids matched column names susie object's alpha p1 prior probability SNP associated trait 1, default 1e-4 p2 prior probability SNP associated trait 2, default 1e-4 p12 prior probability SNP associated traits, default 1e-5 susie.args named list arguments passed susieR::susie_rss() ... arguments passed coloc.bf_bf, particular prior values causal association one trait (p1, p2) (p12) prior weights.","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.susie_bf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"run coloc using susie to detect separate signals — coloc.susie_bf","text":"coloc.signals style result","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc.susie_bf.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"run coloc using susie to detect separate signals — coloc.susie_bf","text":"Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc_test_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulated data to use in testing and vignettes in the coloc package — coloc_test_data","title":"Simulated data to use in testing and vignettes in the coloc package — coloc_test_data","text":"Simulated data use testing vignettes coloc package","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc_test_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulated data to use in testing and vignettes in the coloc package — coloc_test_data","text":"","code":"data(coloc_test_data)"},{"path":"https://chr1swallace.github.io/coloc/reference/coloc_test_data.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Simulated data to use in testing and vignettes in the coloc package — coloc_test_data","text":"four two coloc-style datasets. Elements D1 D2 single shared causal variant, 50 SNPs. Elements D3 D4 100 SNPs, one shared causal variant, one variant unique D3. Use examples coloc-style dataset quantitative trait look like.","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/coloc_test_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulated data to use in testing and vignettes in the coloc package — coloc_test_data","text":"","code":"data(coloc_test_data) names(coloc_test_data) #> [1] \"D1\"      \"D2\"      \"D3\"      \"D4\"      \"causals\" str(coloc_test_data$D1) #> List of 9 #>  $ beta    : num [1:500] 0.337 0.211 0.257 0.267 0.247 ... #>  $ varbeta : num [1:500] 0.01634 0.00532 0.00748 0.01339 0.00664 ... #>  $ N       : int 1000 #>  $ sdY     : num 1.1 #>  $ type    : chr \"quant\" #>  $ MAF     : num [1:500] 0.031 0.166 0.0925 0.0405 0.118 ... #>  $ LD      : num [1:500, 1:500] 1 0.365 0.54 0.851 0.463 ... #>   ..- attr(*, \"dimnames\")=List of 2 #>   .. ..$ : chr [1:500] \"s1\" \"s2\" \"s3\" \"s4\" ... #>   .. ..$ : chr [1:500] \"s1\" \"s2\" \"s3\" \"s4\" ... #>  $ snp     : chr [1:500] \"s1\" \"s2\" \"s3\" \"s4\" ... #>  $ position: int [1:500] 1 2 3 4 5 6 7 8 9 10 ... check_dataset(coloc_test_data$D1) # should return NULL if data structure is ok #> NULL"},{"path":"https://chr1swallace.github.io/coloc/reference/combine.abf.html","id":null,"dir":"Reference","previous_headings":"","what":"combine.abf — combine.abf","title":"combine.abf — combine.abf","text":"Internal function, calculate posterior probabilities configurations, given logABFs SNP prior probs","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/combine.abf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"combine.abf — combine.abf","text":"","code":"combine.abf(l1, l2, p1, p2, p12, quiet = FALSE)"},{"path":"https://chr1swallace.github.io/coloc/reference/combine.abf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"combine.abf — combine.abf","text":"l1 merged.df$lABF.df1 l2 merged.df$lABF.df2 p1 prior probability SNP associated trait 1, default 1e-4 p2 prior probability SNP associated trait 2, default 1e-4 p12 prior probability SNP associated traits, default 1e-5 quiet print posterior summary TRUE. default=FALSE","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/combine.abf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"combine.abf — combine.abf","text":"named numeric vector posterior probabilities","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/combine.abf.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"combine.abf — combine.abf","text":"Claudia Giambartolomei, Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/credible.sets.html","id":null,"dir":"Reference","previous_headings":"","what":"credible.sets — credible.sets","title":"credible.sets — credible.sets","text":"Get credible sets finemapping results","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/credible.sets.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"credible.sets — credible.sets","text":"","code":"credible.sets(dataset, credible.size = 0.95)"},{"path":"https://chr1swallace.github.io/coloc/reference/credible.sets.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"credible.sets — credible.sets","text":"dataset data.frame output finemap.abf() credible.size threshold credible set (Default: 0.95)","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/credible.sets.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"credible.sets — credible.sets","text":"SNP ids credible set","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/credible.sets.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"credible.sets — credible.sets","text":"Guillermo Reales, Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/eqtlgen_density_data.html","id":null,"dir":"Reference","previous_headings":"","what":"eQTLGen estimated distance density — eqtlgen_density_data","title":"eQTLGen estimated distance density — eqtlgen_density_data","text":"eQTLGen estimated distance density","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/eqtlgen_density_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"eQTLGen estimated distance density — eqtlgen_density_data","text":"","code":"data(eqtlgen_density_data)"},{"path":"https://chr1swallace.github.io/coloc/reference/eqtlgen_density_data.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"eQTLGen estimated distance density — eqtlgen_density_data","text":"data.frame two columns, \"rel_dist\" relative distance TSS \"dens_value\" estimated value density. density esimated eQTLGen data. details density estiamted see Pullin Wallace (2024+).","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/eqtlgen_density_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"eQTLGen estimated distance density — eqtlgen_density_data","text":"","code":"data(eqtlgen_density_data) names(eqtlgen_density_data) #> [1] \"rel_dist\"   \"dens_value\""},{"path":"https://chr1swallace.github.io/coloc/reference/est_cond.html","id":null,"dir":"Reference","previous_headings":"","what":"generate conditional summary stats — est_cond","title":"generate conditional summary stats — est_cond","text":"Internal helper function est_all_cond","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/est_cond.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"generate conditional summary stats — est_cond","text":"","code":"est_cond(x, LD, YY, sigsnps, xtx = NULL)"},{"path":"https://chr1swallace.github.io/coloc/reference/est_cond.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"generate conditional summary stats — est_cond","text":"x coloc dataset LD named matrix r YY sum((Y-Ybar)^2) sigsnps names snps jointly condition xtx optional, matrix X'X X genotype matrix. available, estimated LD, MAF, beta sample size (last three part coloc dataset)","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/est_cond.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"generate conditional summary stats — est_cond","text":"data.table giving snp, beta varbeta remaining snps conditioning","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/est_cond.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"generate conditional summary stats — est_cond","text":"Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/estgeno1.html","id":null,"dir":"Reference","previous_headings":"","what":"estgeno1 — estgeno.1.ctl","title":"estgeno1 — estgeno.1.ctl","text":"Estimate single snp frequency distibutions","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/estgeno1.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"estgeno1 — estgeno.1.ctl","text":"","code":"estgeno.1.ctl(f)  estgeno.1.cse(G0, b)"},{"path":"https://chr1swallace.github.io/coloc/reference/estgeno1.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"estgeno1 — estgeno.1.ctl","text":"f MAF G0 single snp frequency controls (vector length 3) - obtained estgeno.1.ctl b log odds ratio","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/estgeno1.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"estgeno1 — estgeno.1.ctl","text":"relative frequency genotypes 0, 1, 2","code":""},{"path":[]},{"path":"https://chr1swallace.github.io/coloc/reference/estgeno1.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"estgeno1 — estgeno.1.ctl","text":"Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/find.best.signal.html","id":null,"dir":"Reference","previous_headings":"","what":"Pick out snp with most extreme Z score — find.best.signal","title":"Pick out snp with most extreme Z score — find.best.signal","text":"Internal helper function","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/find.best.signal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pick out snp with most extreme Z score — find.best.signal","text":"","code":"find.best.signal(D)"},{"path":"https://chr1swallace.github.io/coloc/reference/find.best.signal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pick out snp with most extreme Z score — find.best.signal","text":"D standard format coloc dataset","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/find.best.signal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pick out snp with most extreme Z score — find.best.signal","text":"z significant snp, named snp id","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/find.best.signal.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Pick out snp with most extreme Z score — find.best.signal","text":"Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/findends.html","id":null,"dir":"Reference","previous_headings":"","what":"trim a dataset to central peak(s) — findends","title":"trim a dataset to central peak(s) — findends","text":"tries smart detecting interesting subregion finemap/coloc.","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/findends.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"trim a dataset to central peak(s) — findends","text":"","code":"findends(d, maxz = 4, maxr2 = 0.1, do.plot = FALSE)"},{"path":"https://chr1swallace.github.io/coloc/reference/findends.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"trim a dataset to central peak(s) — findends","text":"d coloc dataset maxz keep snps leftmost rightmost snp |z| > maxz maxr2 expand window keep snps snps r2 > maxr2 left/rightmost snps defined maxz threshold .plot TRUE, plot dataset + boundaries","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/findends.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"trim a dataset to central peak(s) — findends","text":"logical vector length d$position indicating snps keep","code":""},{"path":[]},{"path":"https://chr1swallace.github.io/coloc/reference/findends.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"trim a dataset to central peak(s) — findends","text":"Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/findpeaks.html","id":null,"dir":"Reference","previous_headings":"","what":"trim a dataset to only peak(s) — findpeaks","title":"trim a dataset to only peak(s) — findpeaks","text":"tries smart detecting interesting subregion finemap/coloc.","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/findpeaks.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"trim a dataset to only peak(s) — findpeaks","text":"","code":"findpeaks(d, maxz = 4, maxr2 = 0.1, do.plot = FALSE)"},{"path":"https://chr1swallace.github.io/coloc/reference/findpeaks.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"trim a dataset to only peak(s) — findpeaks","text":"d coloc dataset maxz keep snps leftmost rightmost snp |z| > maxz maxr2 expand window keep snps snps r2 > maxr2 left/rightmost snps defined maxz threshold .plot TRUE, plot dataset + boundaries","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/findpeaks.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"trim a dataset to only peak(s) — findpeaks","text":"logical vector length d$position indicating snps keep","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/findpeaks.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"trim a dataset to only peak(s) — findpeaks","text":"Differs findends finding multiple separate regions multiple peaks","code":""},{"path":[]},{"path":"https://chr1swallace.github.io/coloc/reference/findpeaks.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"trim a dataset to only peak(s) — findpeaks","text":"Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/finemap.abf.html","id":null,"dir":"Reference","previous_headings":"","what":"Bayesian finemapping analysis — finemap.abf","title":"Bayesian finemapping analysis — finemap.abf","text":"Bayesian finemapping analysis","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/finemap.abf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bayesian finemapping analysis — finemap.abf","text":"","code":"finemap.abf(dataset, p1 = 1e-04, prior_weights = NULL)"},{"path":"https://chr1swallace.github.io/coloc/reference/finemap.abf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bayesian finemapping analysis — finemap.abf","text":"dataset list specifically named elements defining dataset analysed. See check_dataset details. p1 prior probability SNP associated trait 1, default 1e-4 prior_weights Non-negative weights prior probability SNP causal","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/finemap.abf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bayesian finemapping analysis — finemap.abf","text":"data.frame: annotated version input data containing log Approximate Bayes Factors intermediate calculations, posterior probability SNP causal","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/finemap.abf.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Bayesian finemapping analysis — finemap.abf","text":"function calculates posterior probabilities different causal variant single trait. regression coefficients variances available, calculates Bayes factors association SNP.  p values available, uses approximation depends SNP's MAF ignores uncertainty imputation.  Regression coefficients used available.","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/finemap.abf.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Bayesian finemapping analysis — finemap.abf","text":"Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/finemap.bf.html","id":null,"dir":"Reference","previous_headings":"","what":"Finemap data through Bayes factors — finemap.bf","title":"Finemap data through Bayes factors — finemap.bf","text":"Finemap one dataset represented Bayes factors","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/finemap.bf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Finemap data through Bayes factors — finemap.bf","text":"","code":"finemap.bf(bf1, p1 = 1e-04)"},{"path":"https://chr1swallace.github.io/coloc/reference/finemap.bf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Finemap data through Bayes factors — finemap.bf","text":"bf1 named vector log BF, matrix log BF colnames (cols=snps, rows=signals) p1 prior probability SNP associated trait 1, default 1e-4","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/finemap.bf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Finemap data through Bayes factors — finemap.bf","text":"finemap.signals style result","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/finemap.bf.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Finemap data through Bayes factors — finemap.bf","text":"workhorse behind many finemap functions","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/finemap.bf.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Finemap data through Bayes factors — finemap.bf","text":"Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/finemap.signals.html","id":null,"dir":"Reference","previous_headings":"","what":"Finemap multiple signals in a single dataset — finemap.signals","title":"Finemap multiple signals in a single dataset — finemap.signals","text":"analogue finemap.abf, adapted find multiple signals exist, via conditioning masking - ie stepwise procedure","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/finemap.signals.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Finemap multiple signals in a single dataset — finemap.signals","text":"","code":"finemap.signals(   D,   LD = D$LD,   method = c(\"single\", \"mask\", \"cond\"),   r2thr = 0.01,   sigsnps = NULL,   pthr = 1e-06,   maxhits = 3,   return.pp = FALSE )"},{"path":"https://chr1swallace.github.io/coloc/reference/finemap.signals.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Finemap multiple signals in a single dataset — finemap.signals","text":"D list summary stats single disease, see check_dataset LD matrix signed r values (rsq!) giving correlation SNPs method method=\"cond\", use conditioning coloc multiple signals. default mask - less powerful, safer assume LD matrix properly allelically aligned estimated effect r2thr mask==TRUE, snps masked r2 > r2thr sigsnps. Otherwise ignored sigsnps SNPs already deemed significant, condition mask, expressed numeric vector, whose names snp names pthr p > pthr, stop successive searching maxhits maximum depth conditioning. procedure stop p > pthr abs(z)<zthr maxhits hits found. return.pp FALSE (default), just return hits. Otherwise return vectors PP mask use masking TRUE, otherwise conditioning. defaults TRUE","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/finemap.signals.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Finemap multiple signals in a single dataset — finemap.signals","text":"list successively significant fine mapped SNPs, named SNPs","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/finemap.signals.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Finemap multiple signals in a single dataset — finemap.signals","text":"Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/logbf_to_pp.html","id":null,"dir":"Reference","previous_headings":"","what":"logbf 2 pp — logbf_to_pp","title":"logbf 2 pp — logbf_to_pp","text":"generic convenience function convert logbf matrix PP matrix","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/logbf_to_pp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"logbf 2 pp — logbf_to_pp","text":"","code":"logbf_to_pp(bf, pi, last_is_null)"},{"path":"https://chr1swallace.github.io/coloc/reference/logbf_to_pp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"logbf 2 pp — logbf_to_pp","text":"bf L p p+1 matrix log Bayes factors pi either scalar representing prior probability snp causal, full vector per snp / null prior probabilities last_is_null TRUE last value bf vector last column bf matrix relates null hypothesis association. standard SuSiE results, may BF constructed ways.","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/logbf_to_pp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"logbf 2 pp — logbf_to_pp","text":"matrix posterior probabilities, dimensions bf","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/logbf_to_pp.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"logbf 2 pp — logbf_to_pp","text":"Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/logdiff.html","id":null,"dir":"Reference","previous_headings":"","what":"logdiff — logdiff","title":"logdiff — logdiff","text":"Internal function, logdiff","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/logdiff.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"logdiff — logdiff","text":"","code":"logdiff(x, y)"},{"path":"https://chr1swallace.github.io/coloc/reference/logdiff.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"logdiff — logdiff","text":"x numeric y numeric","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/logdiff.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"logdiff — logdiff","text":"max(x) + log(exp(x - max(x,y)) - exp(y-max(x,y)))","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/logdiff.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"logdiff — logdiff","text":"function calculates log difference exponentiated logs taking max, .e. insuring difference negative","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/logdiff.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"logdiff — logdiff","text":"Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/logsum.html","id":null,"dir":"Reference","previous_headings":"","what":"logsum — logsum","title":"logsum — logsum","text":"Internal function, logsum","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/logsum.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"logsum — logsum","text":"","code":"logsum(x)"},{"path":"https://chr1swallace.github.io/coloc/reference/logsum.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"logsum — logsum","text":"x numeric vector","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/logsum.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"logsum — logsum","text":"max(x) + log(sum(exp(x - max(x))))","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/logsum.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"logsum — logsum","text":"function calculates log sum exponentiated logs taking max, .e. insuring sum Inf","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/logsum.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"logsum — logsum","text":"Claudia Giambartolomei","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/map_cond.html","id":null,"dir":"Reference","previous_headings":"","what":"find the next most significant SNP, conditioning on a list of sigsnps — map_cond","title":"find the next most significant SNP, conditioning on a list of sigsnps — map_cond","text":"Internal helper function finemap.signals","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/map_cond.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"find the next most significant SNP, conditioning on a list of sigsnps — map_cond","text":"","code":"map_cond(D, LD, YY, sigsnps = NULL)"},{"path":"https://chr1swallace.github.io/coloc/reference/map_cond.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"find the next most significant SNP, conditioning on a list of sigsnps — map_cond","text":"D dataset standard coloc format LD named matrix r YY sum(y^2) sigsnps names snps mask","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/map_cond.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"find the next most significant SNP, conditioning on a list of sigsnps — map_cond","text":"named numeric - Z score named snp","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/map_cond.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"find the next most significant SNP, conditioning on a list of sigsnps — map_cond","text":"Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/map_mask.html","id":null,"dir":"Reference","previous_headings":"","what":"find the next most significant SNP, masking a list of sigsnps — map_mask","title":"find the next most significant SNP, masking a list of sigsnps — map_mask","text":"Internal helper function finemap.signals","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/map_mask.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"find the next most significant SNP, masking a list of sigsnps — map_mask","text":"","code":"map_mask(D, LD, r2thr = 0.01, sigsnps = NULL)"},{"path":"https://chr1swallace.github.io/coloc/reference/map_mask.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"find the next most significant SNP, masking a list of sigsnps — map_mask","text":"D dataset standard coloc format LD named matrix r r2thr mask snps r2 > r2thr sigsnps sigsnps names snps mask","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/map_mask.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"find the next most significant SNP, masking a list of sigsnps — map_mask","text":"named numeric - Z score named snp","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/map_mask.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"find the next most significant SNP, masking a list of sigsnps — map_mask","text":"Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/plot-methods.html","id":null,"dir":"Reference","previous_headings":"","what":"plot a coloc_abf object — plot.coloc_abf","title":"plot a coloc_abf object — plot.coloc_abf","text":"plot coloc_abf object","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/plot-methods.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plot a coloc_abf object — plot.coloc_abf","text":"","code":"# S3 method for class 'coloc_abf' plot(x, ...)"},{"path":"https://chr1swallace.github.io/coloc/reference/plot-methods.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plot a coloc_abf object — plot.coloc_abf","text":"x coloc_abf object plotted ... arguments","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/plot-methods.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plot a coloc_abf object — plot.coloc_abf","text":"ggplot object","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/plot-methods.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"plot a coloc_abf object — plot.coloc_abf","text":"Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/plot_dataset.html","id":null,"dir":"Reference","previous_headings":"","what":"plot a coloc dataset — plot_dataset","title":"plot a coloc dataset — plot_dataset","text":"Plot coloc structured dataset","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/plot_dataset.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plot a coloc dataset — plot_dataset","text":"","code":"plot_dataset(   d,   susie_obj = NULL,   highlight_list = NULL,   alty = NULL,   ylab = \"-log10(p)\",   show_legend = TRUE,   color = c(\"dodgerblue2\", \"green4\", \"#6A3D9A\", \"#FF7F00\", \"gold1\", \"skyblue2\",     \"#FB9A99\", \"palegreen2\", \"#CAB2D6\", \"#FDBF6F\", \"gray70\", \"khaki2\", \"maroon\",     \"orchid1\", \"deeppink1\", \"blue1\", \"steelblue4\", \"darkturquoise\", \"green1\", \"yellow4\",     \"yellow3\", \"darkorange4\", \"brown\"),   ... )"},{"path":"https://chr1swallace.github.io/coloc/reference/plot_dataset.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plot a coloc dataset — plot_dataset","text":"d coloc dataset susie_obj optional, output call runsusie() highlight_list optional, list character vectors. snp character vector highlighted, using different colour list. alty default plot standard manhattan. wish plot different y value, pass . may also want change ylab describe plotting. ylab label y axis, default -log10(p) assumes plotting manhattan show_legend optional, show legend . default TRUE color optional, specify colours use credible set susie_obj supplied. Default shamelessly copied susieR::susie_plot() colours match ... arguments passed base graphics plot() function","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/plot_dataset.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"plot a coloc dataset — plot_dataset","text":"Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/plot_datasets.html","id":null,"dir":"Reference","previous_headings":"","what":"plot a pair of coloc datasets, highlighting the snps that are common between them — plot_datasets","title":"plot a pair of coloc datasets, highlighting the snps that are common between them — plot_datasets","text":"plot pair coloc datasets, highlighting snps common ","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/plot_datasets.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plot a pair of coloc datasets, highlighting the snps that are common between them — plot_datasets","text":"","code":"plot_datasets(d1, d2, color = \"dodgerblue2\")"},{"path":"https://chr1swallace.github.io/coloc/reference/plot_datasets.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plot a pair of coloc datasets, highlighting the snps that are common between them — plot_datasets","text":"d1 coloc dataset d2 another coloc dataset color optional, specify colour use highlighting","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/plot_datasets.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plot a pair of coloc datasets, highlighting the snps that are common between them — plot_datasets","text":"plots base graphics figure two panels","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/plot_datasets.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"plot a pair of coloc datasets, highlighting the snps that are common between them — plot_datasets","text":"Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/plot_extended_datasets.html","id":null,"dir":"Reference","previous_headings":"","what":"Draw extended plot of summary statistics for two coloc datasets — plot_extended_datasets","title":"Draw extended plot of summary statistics for two coloc datasets — plot_extended_datasets","text":"Draw Manhattan-style locus plots p-values dataset, gene annotations, scatter plot z-scores, table coloc summary statistics.","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/plot_extended_datasets.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Draw extended plot of summary statistics for two coloc datasets — plot_extended_datasets","text":"","code":"plot_extended_datasets(   d1,   d2,   x,   first_highlight_list = NULL,   second_highlight_list = NULL,   first_index_snp = NULL,   second_index_snp = NULL,   first_trait = \"Trait 1\",   second_trait = \"Trait 2\",   snp_label = \"snp\",   ld_label = NULL,   show_ld = FALSE,   locus_plot_ylim = NULL,   ens_db = \"EnsDb.Hsapiens.v86\" )"},{"path":"https://chr1swallace.github.io/coloc/reference/plot_extended_datasets.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Draw extended plot of summary statistics for two coloc datasets — plot_extended_datasets","text":"d1 coloc dataset d2 another coloc dataset x object class coloc_abf returned coloc.abf() first_highlight_list character vector snps highlight first dataset; 'index' can passed highlight significant SNP second_highlight_list character vector snps highlight second dataset; 'index' can passed highlight significant SNP first_index_snp snp designate index snp first dataset purpose LD visualisation second_index_snp snp designate index snp second dataset purpose LD visualisation first_trait label first trait second_trait label second trait snp_label label snp column ld_label label LD column show_ld logical, whether show LD locus plots locus_plot_ylim numeric vector length 2 specifying y-axis limits locus plots -log10 scale ens_db character string specifying Ensembl database package get gene positions. Current (time writing documentation!) sensible values  \"EnsDb.Hsapiens.v86\" build 38 \"EnsDb.Hsapiens.v75\" build 37.","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/plot_extended_datasets.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Draw extended plot of summary statistics for two coloc datasets — plot_extended_datasets","text":"gtable object","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/plot_extended_datasets.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Draw extended plot of summary statistics for two coloc datasets — plot_extended_datasets","text":"Plot pair coloc datasets extended format function expects first two elements coloc dataset list d contain summary statistics. Columns labelled 'chromosome', 'position', 'p' (p-values) expected dataset. packages locuszoomr one EnsDb.Hsapiens.v86 EnsDb.Hsapiens.v75 required function. One EnsDb.Hsapiens libraries containing Ensembl database specified ens_db must loaded prior  use (see example). EnsDb.Hsapiens.v86 default database (GRCh38/hg19); GRCh37/hg19, use EnsDb.Hsapiens.v75.","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/plot_extended_datasets.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Draw extended plot of summary statistics for two coloc datasets — plot_extended_datasets","text":"Tom Willis","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/plot_extended_datasets.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Draw extended plot of summary statistics for two coloc datasets — plot_extended_datasets","text":"","code":"if (FALSE) { # \\dontrun{ library(coloc) library(EnsDb.Hsapiens.v86) plot(plot_extended_dataset(list(first_dataset, second_dataset), coloc, first_highlight_list = c(\"rs123\", \"rs456\"),  second_highlight_list = c(\"rs789\", \"rs1011\"),  ens_db = \"EnsDb.Hsapiens.v86\")) } # }"},{"path":"https://chr1swallace.github.io/coloc/reference/print-methods.html","id":null,"dir":"Reference","previous_headings":"","what":"print.coloc_abf — print.coloc_abf","title":"print.coloc_abf — print.coloc_abf","text":"Print summary coloc.abf run","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/print-methods.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"print.coloc_abf — print.coloc_abf","text":"","code":"# S3 method for class 'coloc_abf' print(x, ...)"},{"path":"https://chr1swallace.github.io/coloc/reference/print-methods.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"print.coloc_abf — print.coloc_abf","text":"x object class coloc_abf returned coloc.abf() coloc.signals() ... optional arguments: \"trait1\" name trait 1, \"trait2\" name trait 2","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/print-methods.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"print.coloc_abf — print.coloc_abf","text":"x, invisibly","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/print-methods.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"print.coloc_abf — print.coloc_abf","text":"Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/process.dataset.html","id":null,"dir":"Reference","previous_headings":"","what":"process.dataset — process.dataset","title":"process.dataset — process.dataset","text":"Internal function, process dataset list coloc.abf.","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/process.dataset.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"process.dataset — process.dataset","text":"","code":"process.dataset(d, suffix, ...)"},{"path":"https://chr1swallace.github.io/coloc/reference/process.dataset.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"process.dataset — process.dataset","text":"d list suffix \"df1\" \"df2\" ... used pass parameters approx.bf.estimates, particular effect_priors parameter","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/process.dataset.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"process.dataset — process.dataset","text":"data.frame log(abf) log(bf)","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/process.dataset.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"process.dataset — process.dataset","text":"Made public another package use, intended users use.","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/process.dataset.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"process.dataset — process.dataset","text":"Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/runsusie.html","id":null,"dir":"Reference","previous_headings":"","what":"Run susie on a single coloc-structured dataset — runsusie","title":"Run susie on a single coloc-structured dataset — runsusie","text":"run susie_rss storing additional information coloc","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/runsusie.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run susie on a single coloc-structured dataset — runsusie","text":"","code":"runsusie(   d,   suffix = 1,   maxit = 100,   repeat_until_convergence = TRUE,   s_init = NULL,   ... )"},{"path":"https://chr1swallace.github.io/coloc/reference/runsusie.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run susie on a single coloc-structured dataset — runsusie","text":"d coloc dataset, must include LD (signed correlation matrix) N (sample size) suffix suffix label printed error messages maxit maximum number iterations first run susie_rss(). susie_rss() report convergence, runs extended assuming repeat_until_convergence=TRUE. users need change default. repeat_until_convergence keep running susie_rss() indicates convergence. Default TRUE. FALSE, susie_rss() run maxit iterations, converged, runsusie() error. users need change default. s_init used internally extend runs converged. use. ... arguments passed susie_rss. particular, want match coloc defaults, set prior_variance=0.2^2 (case-control trait) (0.15/sd(Y))^2 quantitative trait estimate_prior_variance=FALSE otherwise susie_rss estimate prior variance ","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/runsusie.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run susie on a single coloc-structured dataset — runsusie","text":"results susie_rss run, added dimnames","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/runsusie.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Run susie on a single coloc-structured dataset — runsusie","text":"Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/runsusie.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run susie on a single coloc-structured dataset — runsusie","text":"","code":"library(coloc) data(coloc_test_data) result=runsusie(coloc_test_data$D1) #> running max iterations: 100 #> \tconverged: TRUE summary(result) #>  #> Variables in credible sets: #>  #>  variable variable_prob cs #>       105     0.9593968  1 #>  #> Credible sets summary: #>  #>  cs cs_log10bf cs_avg_r2 cs_min_r2 variable #>   1    10.2121         1         1      105"},{"path":"https://chr1swallace.github.io/coloc/reference/sdY.est.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate trait variance, internal function — sdY.est","title":"Estimate trait variance, internal function — sdY.est","text":"Estimate trait standard deviation given vectors variance coefficients,  MAF sample size","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/sdY.est.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate trait variance, internal function — sdY.est","text":"","code":"sdY.est(vbeta, maf, n)"},{"path":"https://chr1swallace.github.io/coloc/reference/sdY.est.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate trait variance, internal function — sdY.est","text":"vbeta vector variance coefficients maf vector MAF (length vbeta) n sample size","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/sdY.est.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate trait variance, internal function — sdY.est","text":"estimated standard deviation Y","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/sdY.est.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate trait variance, internal function — sdY.est","text":"Estimate based var(beta-hat) = var(Y) / (n * var(X)) var(X) = 2maf(1-maf) can estimate var(Y) regressing n*var(X) 1/var(beta)","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/sdY.est.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Estimate trait variance, internal function — sdY.est","text":"Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/sensitivity.html","id":null,"dir":"Reference","previous_headings":"","what":"Prior sensitivity for coloc — sensitivity","title":"Prior sensitivity for coloc — sensitivity","text":"Shows prior posterior per-hypothesis probabilities change function p12","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/sensitivity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prior sensitivity for coloc — sensitivity","text":"","code":"sensitivity(   obj,   rule = \"\",   dataset1 = NULL,   dataset2 = NULL,   npoints = 100,   doplot = TRUE,   plot.manhattans = TRUE,   preserve.par = FALSE,   row = 1 )"},{"path":"https://chr1swallace.github.io/coloc/reference/sensitivity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prior sensitivity for coloc — sensitivity","text":"obj output coloc.detail coloc.process rule decision rule.  states values posterior probabilities \"pass\" threshold.  string parsed evaluated, better explained examples.  \"H4 > 0.5\" says post prob H4 > 0.5 pass.  \"H4 > 0.9 & H4/H3 > 3\" says post prob H4 must > 0.9 must least 3 times post prob H3.\" dataset1 optional dataset1 used run SuSiE. used make Manhattan plot plot.manhattans=TRUE. dataset2 optional dataset2 used run SuSiE. used make Manhattan plot plot.manhattans=TRUE. npoints number points evaluate prior values p12, equally spaced log scale p1*p2 min(p1,p2) - logical limits p12, scientifically sensible values. doplot draw plot. set FALSE want just evaluate prior posterior matrices work plot.manhattans TRUE, show Manhattans input data preserve.par TRUE, change par() current graphics device - allow sensitivity plots incoporated larger set plots, plot one per page pdf, example row coloc.signals() used multiple rows returned coloc summary, row plot","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/sensitivity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prior sensitivity for coloc — sensitivity","text":"list 3: prior matrix, posterior matrix, pass/fail indicator (returned invisibly)","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/sensitivity.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prior sensitivity for coloc — sensitivity","text":"Function called mainly plotting side effect.  draws two plots, showing prior posterior probabilities coloc hypothesis change changing p12.  decision rule sets values posterior probabilities considered acceptable, used shade green region plot p12 prior give acceptable result.  user encouraged consider carefully whether prior values shown within green shaded region sensible accepting hypothesis.  shading shown, priors give rise accepted result.","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/sensitivity.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Prior sensitivity for coloc — sensitivity","text":"Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/subset_dataset.html","id":null,"dir":"Reference","previous_headings":"","what":"subset_dataset — subset_dataset","title":"subset_dataset — subset_dataset","text":"Subset coloc dataset","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/subset_dataset.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"subset_dataset — subset_dataset","text":"","code":"subset_dataset(dataset, index)"},{"path":"https://chr1swallace.github.io/coloc/reference/subset_dataset.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"subset_dataset — subset_dataset","text":"dataset coloc dataset index vector indices snps KEEP","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/subset_dataset.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"subset_dataset — subset_dataset","text":"copy dataset, data relating snps index remaining","code":""},{"path":"https://chr1swallace.github.io/coloc/reference/subset_dataset.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"subset_dataset — subset_dataset","text":"Chris Wallace","code":""},{"path":"https://chr1swallace.github.io/coloc/news/index.html","id":"coloc-600","dir":"Changelog","previous_headings":"","what":"coloc 6.0.0","title":"coloc 6.0.0","text":"Add new ability calculate varying prior probabilities based distance gene eQTL datasets Add new plot_extended_data function produce nice QC plots coloc","code":""},{"path":"https://chr1swallace.github.io/coloc/news/index.html","id":"coloc-523","dir":"Changelog","previous_headings":"","what":"coloc 5.2.3","title":"coloc 5.2.3","text":"CRAN release: 2023-10-03 minor change, another package able access one internal functions, exported","code":""},{"path":"https://chr1swallace.github.io/coloc/news/index.html","id":"coloc-522","dir":"Changelog","previous_headings":"","what":"coloc 5.2.2","title":"coloc 5.2.2","text":"CRAN release: 2023-05-12 better checking dataset inputs, better documentation data look like","code":""},{"path":"https://chr1swallace.github.io/coloc/news/index.html","id":"coloc-520","dir":"Changelog","previous_headings":"","what":"coloc 5.2.0","title":"coloc 5.2.0","text":"update new susieR >= 0.12.06 requires sample size general tidy susie-related code new functions help find subregions finemapping - findpeaks, findends updated FAQ.md tidied empty items documentation make CRAN happy slimmed example dataset make CRAN even happier","code":""},{"path":"https://chr1swallace.github.io/coloc/news/index.html","id":"coloc-512","dir":"Changelog","previous_headings":"","what":"coloc 5.1.2","title":"coloc 5.1.2","text":"deprecate runsusie() argument p","code":""},{"path":"https://chr1swallace.github.io/coloc/news/index.html","id":"coloc-511","dir":"Changelog","previous_headings":"","what":"coloc 5.1.1","title":"coloc 5.1.1","text":"update plot_dataset() sensitivity() fix bug small p values displaying 0","code":""},{"path":"https://chr1swallace.github.io/coloc/news/index.html","id":"coloc-510","dir":"Changelog","previous_headings":"","what":"coloc 5.1.0","title":"coloc 5.1.0","text":"CRAN release: 2021-06-14 release CRAN coloc.susie remove nref now recommended","code":""},{"path":"https://chr1swallace.github.io/coloc/news/index.html","id":"coloc-5009002","dir":"Changelog","previous_headings":"","what":"coloc 5.0.0.9002","title":"coloc 5.0.0.9002","text":"runsusie, allow nref overridden user passes z_ld_weight","code":""},{"path":"https://chr1swallace.github.io/coloc/news/index.html","id":"coloc-5009001","dir":"Changelog","previous_headings":"","what":"coloc 5.0.0.9001","title":"coloc 5.0.0.9001","text":"deprecate coloc.signals multiple causal variants introduce coloc.susie multiple causal variants new vignette 02_data giving details structuring data properly","code":""},{"path":"https://chr1swallace.github.io/coloc/news/index.html","id":"coloc-40-5","dir":"Changelog","previous_headings":"","what":"coloc 4.0-5","title":"coloc 4.0-5","text":"update error checking","code":""},{"path":"https://chr1swallace.github.io/coloc/news/index.html","id":"coloc-40-3","dir":"Changelog","previous_headings":"","what":"coloc 4.0-3","title":"coloc 4.0-3","text":"BUGFIX missing sdY type=“quant” error finemap.signals coloc.signals, now estimated missing. warning factors used snp names added (issue #29)","code":""},{"path":"https://chr1swallace.github.io/coloc/news/index.html","id":"coloc-40-2","dir":"Changelog","previous_headings":"","what":"coloc 4.0-2","title":"coloc 4.0-2","text":"BUGFIX snps second dataset might masked intended. result effect using “single” option trait 2 masking expected.","code":""},{"path":"https://chr1swallace.github.io/coloc/news/index.html","id":"coloc-40-0","dir":"Changelog","previous_headings":"","what":"coloc 4.0-0","title":"coloc 4.0-0","text":"new functions: coloc.signals, finemap.abf - analogues coloc.abf finemap.abf allow multiple causal variants. See vignette conditioning/masking new function: sensitivity - post-hoc, determine sensitivity coloc results changes prior. See vignette sensitivity 2019-06-25","code":""},{"path":"https://chr1swallace.github.io/coloc/news/index.html","id":"coloc-32-1","dir":"Changelog","previous_headings":"","what":"coloc 3.2-1","title":"coloc 3.2-1","text":"CRAN release: 2019-05-17 BUGFIX: finemap.abf() low power situations, posterior H0 previously low. affect datasets minimum p value > 1e-7 - ie posterior H0 expected much 0.","code":""},{"path":"https://chr1swallace.github.io/coloc/news/index.html","id":"coloc-32","dir":"Changelog","previous_headings":"","what":"coloc 3.2","title":"coloc 3.2","text":"fix bug process.datasets suggested MAF needed cc data beta/varbeta also present added pkgdown 2018-09-28","code":""},{"path":"https://chr1swallace.github.io/coloc/news/index.html","id":"coloc-31","dir":"Changelog","previous_headings":"","what":"coloc 3.1","title":"coloc 3.1","text":"CRAN release: 2018-02-24 new function: finemap.abf - improved clarity error messages coloc.abf() sub functions - added finemap.abf fine map single trait - fixed warnings caused CRAN disliking BioConductor devel branch 2018-02-22","code":""},{"path":"https://chr1swallace.github.io/coloc/news/index.html","id":"coloc-24","dir":"Changelog","previous_headings":"","what":"coloc 2.4","title":"coloc 2.4","text":"added stratification proportional testing approaches 2017-03-21","code":""},{"path":"https://chr1swallace.github.io/coloc/news/index.html","id":"coloc-23-2","dir":"Changelog","previous_headings":"","what":"coloc 2.3-2","title":"coloc 2.3-2","text":"tidied code relating mainly proportional colocalisation testing methods, making methods confirm S4. pcs.prepare now imputes missing genotypes default 2013-05-22","code":""},{"path":"https://chr1swallace.github.io/coloc/news/index.html","id":"coloc-23","dir":"Changelog","previous_headings":"","what":"coloc 2.3","title":"coloc 2.3","text":"CRAN release: 2013-09-25","code":""},{"path":"https://chr1swallace.github.io/coloc/news/index.html","id":"coloc-bugfix-2-3","dir":"Changelog","previous_headings":"","what":"coloc BUGFIX","title":"coloc 2.3","text":"Introduced function estimate trait variance supplied coefficients standard errors. used within approach implemented coloc.abf(), replaces earlier version implicitly assumed var(Y)=1 quantitative traits, lead incorrect inference var(Y) far 1. 2013-09-25","code":""},{"path":"https://chr1swallace.github.io/coloc/news/index.html","id":"coloc-22","dir":"Changelog","previous_headings":"","what":"coloc 2.2","title":"coloc 2.2","text":"CRAN release: 2013-06-19 Merged coloc.abf coloc.abf.imputed(), datasets beta, var(beta) available can matched datasets p values maf.2 means arguments coloc.abf() changed! Please check ?coloc.abf new function. 2013-19-06","code":""},{"path":"https://chr1swallace.github.io/coloc/news/index.html","id":"coloc-21","dir":"Changelog","previous_headings":"","what":"coloc 2.1","title":"coloc 2.1","text":"CRAN release: 2013-06-03 Bug fix coloc.abf() function, used p12 instead log(p12) calculate L4. New function coloc.abf.imputed() make better use fuller information imputed data. 2013-03-06","code":""},{"path":"https://chr1swallace.github.io/coloc/news/index.html","id":"coloc-20","dir":"Changelog","previous_headings":"","what":"coloc 2.0","title":"coloc 2.0","text":"CRAN release: 2013-05-23 New function, coloc.abf(), implement colocalisation approach described Giambartolomei et. al. Changes coloc.test() coloc.bma() functions make consistent regards arguments output. 2013-22-05","code":""},{"path":"https://chr1swallace.github.io/coloc/news/index.html","id":"coloc-111","dir":"Changelog","previous_headings":"","what":"coloc 1.11","title":"coloc 1.11","text":"CRAN release: 2013-01-25 added principal components functions pcs.prepare(), pcs.model(). Restructed coloc objects separate Bayesian non-Bayesian inference. 2012-12-10","code":""},{"path":"https://chr1swallace.github.io/coloc/news/index.html","id":"coloc-110","dir":"Changelog","previous_headings":"","what":"coloc 1.10","title":"coloc 1.10","text":"CRAN release: 2012-11-30 added Credible Interval calculation coloc.test(). 2012-11-28","code":""},{"path":"https://chr1swallace.github.io/coloc/news/index.html","id":"coloc-109","dir":"Changelog","previous_headings":"","what":"coloc 1.09","title":"coloc 1.09","text":"updated return u Var(u) addition chisq statistic. 2012-07-12","code":""},{"path":"https://chr1swallace.github.io/coloc/news/index.html","id":"coloc-108","dir":"Changelog","previous_headings":"","what":"coloc 1.08","title":"coloc 1.08","text":"CRAN release: 2012-04-12 fixed error documentation, added MASS Depends. 2012-04-12","code":""},{"path":"https://chr1swallace.github.io/coloc/news/index.html","id":"coloc-106","dir":"Changelog","previous_headings":"","what":"coloc 1.06","title":"coloc 1.06","text":"tidying. 2012-01-05","code":""},{"path":"https://chr1swallace.github.io/coloc/news/index.html","id":"coloc-105","dir":"Changelog","previous_headings":"","what":"coloc 1.05","title":"coloc 1.05","text":"CRAN release: 2012-01-04 moved S4 methods. 2012-01-03","code":""},{"path":"https://chr1swallace.github.io/coloc/news/index.html","id":"coloc-104","dir":"Changelog","previous_headings":"","what":"coloc 1.04","title":"coloc 1.04","text":"made means generating plots flexible. 2011-12-27","code":""}]
